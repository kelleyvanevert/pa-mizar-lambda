<!DOCTYPE HTML>
<html>
<head>
  <title>Lambda calculus</title>
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="res/style.css" />
  <meta charset="utf8">
</head>
<body>
  <ul class="tools">
    <li><a href="#top">▴</a></li>
    <li><a href="#toc">□</a></li>
  </ul>
  
  <div id="container">
    <div id="background"></div>
    <ul class="fragments" id="top">
        
        
        <li>
            <div class="annotation annotation-0">
              
                <h1 id="hd-top">
                  
                  Lambda calculus
                </h1>
              

              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-1">
              
                <p>Original files:
 <a href="text/lambda.abs">.abs</a>,
 <a href="text/lambda.miz">.miz</a>,
 <a href="dict/lambda.voc">.voc</a></p>
<p><div class="toc" id="toc"><h2>Contents</h2><ul><li class="depth-2"><span class="headnumber depth-2">1</span><span class="contain depth-2"><a href="#hd-1" class="depth-2">Syntax and behaviour</a><ul><li class="depth-3"><span class="headnumber depth-3">1.1</span><span class="contain depth-3"><a href="#hd-1.1" class="depth-3">Lambda terms</a><ul><li class="depth-4"><span class="headnumber depth-4">1.1.1</span><span class="contain depth-4"><a href="#hd-1.1.1" class="depth-4">Preservation under operations</a></span></li></ul></span></li>
<li class="depth-3"><span class="headnumber depth-3">1.2</span><span class="contain depth-3"><a href="#hd-1.2" class="depth-3">Helper definitions</a><ul><li class="depth-4"><span class="headnumber depth-4">1.2.1</span><span class="contain depth-4"><a href="#hd-1.2.1" class="depth-4">Variable occurences</a></span></li>
<li class="depth-4"><span class="headnumber depth-4">1.2.2</span><span class="contain depth-4"><a href="#hd-1.2.2" class="depth-4">Abstraction and application</a></span></li></ul></span></li>
<li class="depth-3"><span class="headnumber depth-3">1.3</span><span class="contain depth-3"><a href="#hd-1.3" class="depth-3">Substitution</a><ul><li class="depth-4"><span class="headnumber depth-4">1.3.1</span><span class="contain depth-4"><a href="#hd-1.3.1" class="depth-4">Substitution lemma</a></span></li></ul></span></li>
<li class="depth-3"><span class="headnumber depth-3">1.4</span><span class="contain depth-3"><a href="#hd-1.4" class="depth-3">Reduction and conversion</a></span></li></ul></span></li></ul><div style="clear: both;"></div></div></p>
<p>TODO note how we almost never work by inductive/recursive means,
 in constract with, say, Coq.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-13' id='line-13'>13</a> <span class="comment">:: Environ originally taken from `finseq_2`. Later, I added trees and orders.</span>
<a class='lineno' href='#line-14' id='line-14'>14</a> <span class="keyword">environ</span>
<a class='lineno' href='#line-15' id='line-15'>15</a> 
<a class='lineno' href='#line-16' id='line-16'>16</a>   <span class="comment">:: Vocabularies are basically for Mizar's lexer.</span>
<a class='lineno' href='#line-17' id='line-17'>17</a>   <span class="keyword">vocabularies</span> <span class="reference">LAMBDA</span>,
<a class='lineno' href='#line-18' id='line-18'>18</a>     <span class="reference">FINSET_1</span>,
<a class='lineno' href='#line-19' id='line-19'>19</a>     <span class="reference">NUMBERS</span>,
<a class='lineno' href='#line-20' id='line-20'>20</a>     <span class="reference">NAT_1</span>, <span class="reference">XBOOLE_0</span>, <span class="reference">SUBSET_1</span>, <span class="reference">FINSEQ_1</span>, <span class="reference">XXREAL_0</span>, <span class="reference">CARD_1</span>,
<a class='lineno' href='#line-21' id='line-21'>21</a>     <span class="reference">ARYTM_1</span>, <span class="reference">ARYTM_3</span>, <span class="reference">TARSKI</span>, <span class="reference">ORDINAL4</span>, <span class="reference">FUNCOP_1</span>,
<a class='lineno' href='#line-22' id='line-22'>22</a>     <span class="reference">RELAT_2</span>, <span class="reference">RELAT_1</span>,
<a class='lineno' href='#line-23' id='line-23'>23</a>     <span class="reference">FUNCT_1</span>, <span class="reference">FUNCT_2</span>,
<a class='lineno' href='#line-24' id='line-24'>24</a>     <span class="reference">ZFMISC_1</span>, <span class="reference">PARTFUN1</span>,
<a class='lineno' href='#line-25' id='line-25'>25</a>     <span class="reference">ORDERS_2</span>, <span class="reference">ORDERS_1</span>,
<a class='lineno' href='#line-26' id='line-26'>26</a>     <span class="reference">FINSEQ_2</span>, <span class="reference">FINSEQ_4</span>, <span class="reference">PBOOLE</span>, <span class="reference">CARD_3</span>, <span class="reference">VALUED_1</span>,
<a class='lineno' href='#line-27' id='line-27'>27</a>     <span class="reference">TREES_1</span>, <span class="reference">TREES_2</span>, <span class="reference">TREES_3</span>, <span class="reference">TREES_4</span>;
<a class='lineno' href='#line-28' id='line-28'>28</a>   
<a class='lineno' href='#line-29' id='line-29'>29</a>   <span class="comment">:: Radix type specifications</span>
<a class='lineno' href='#line-30' id='line-30'>30</a>   <span class="comment">:: But it also helped [175 unknown attribute format] error with [finite set]</span>
<a class='lineno' href='#line-31' id='line-31'>31</a>   <span class="keyword">notations</span> <span class="reference">FINSET_1</span>,
<a class='lineno' href='#line-32' id='line-32'>32</a>     <span class="reference">TARSKI</span>, <span class="reference">XBOOLE_0</span>, <span class="reference">ENUMSET1</span>, <span class="reference">ZFMISC_1</span>, <span class="reference">SUBSET_1</span>, <span class="reference">ORDINAL1</span>, <span class="reference">CARD_1</span>,
<a class='lineno' href='#line-33' id='line-33'>33</a>     <span class="reference">NUMBERS</span>, <span class="reference">XCMPLX_0</span>, <span class="reference">DOMAIN_1</span>, <span class="reference">NAT_1</span>, <span class="reference">RELAT_1</span>, <span class="reference">PARTFUN1</span>,
<a class='lineno' href='#line-34' id='line-34'>34</a>     <span class="reference">RELAT_2</span>, <span class="reference">RELSET_1</span>,
<a class='lineno' href='#line-35' id='line-35'>35</a>     <span class="reference">FUNCT_1</span>, <span class="reference">FUNCT_2</span>,
<a class='lineno' href='#line-36' id='line-36'>36</a>     <span class="reference">FUNCT_3</span>, <span class="reference">FINSEQ_1</span>, <span class="reference">FINSEQ_2</span>, <span class="reference">BINOP_1</span>, <span class="reference">PBOOLE</span>, <span class="reference">FUNCOP_1</span>, <span class="reference">CARD_3</span>,
<a class='lineno' href='#line-37' id='line-37'>37</a>     <span class="reference">TREES_1</span>, <span class="reference">TREES_2</span>, <span class="reference">TREES_3</span>, <span class="reference">TREES_4</span>,
<a class='lineno' href='#line-38' id='line-38'>38</a>     <span class="reference">ORDERS_1</span>, <span class="reference">ORDERS_2</span>,
<a class='lineno' href='#line-39' id='line-39'>39</a>     <span class="reference">XXREAL_0</span>, <span class="reference">VALUED_1</span>,
<a class='lineno' href='#line-40' id='line-40'>40</a>     <span class="reference">RECDEF_1</span>;
<a class='lineno' href='#line-41' id='line-41'>41</a> 
<a class='lineno' href='#line-42' id='line-42'>42</a>   <span class="comment">:: For modes? (unknown mode format resolved)</span>
<a class='lineno' href='#line-43' id='line-43'>43</a>   <span class="keyword">constructors</span> <span class="reference">RELAT_2</span>, <span class="reference">RELAT_1</span>,
<a class='lineno' href='#line-44' id='line-44'>44</a>     <span class="reference">PARTFUN1</span>, <span class="reference">BINOP_1</span>, <span class="reference">DOMAIN_1</span>,
<a class='lineno' href='#line-45' id='line-45'>45</a>     <span class="reference">FUNCT_1</span>, <span class="reference">FUNCT_2</span>, <span class="reference">FUNCT_3</span>,
<a class='lineno' href='#line-46' id='line-46'>46</a>     <span class="reference">FUNCOP_1</span>,
<a class='lineno' href='#line-47' id='line-47'>47</a>     <span class="reference">RELSET_1</span>,
<a class='lineno' href='#line-48' id='line-48'>48</a>     <span class="reference">SQUARE_1</span>, <span class="reference">NAT_1</span>, <span class="reference">FINSEQ_1</span>, <span class="reference">FINSEQ_2</span>, <span class="reference">PBOOLE</span>, <span class="reference">CARD_3</span>, <span class="reference">VALUED_1</span>, <span class="reference">SETFAM_1</span>,
<a class='lineno' href='#line-49' id='line-49'>49</a>     <span class="reference">TREES_1</span>, <span class="reference">TREES_2</span>, <span class="reference">TREES_3</span>, <span class="reference">TREES_4</span>,
<a class='lineno' href='#line-50' id='line-50'>50</a>     <span class="reference">ORDERS_1</span>, <span class="reference">ORDERS_2</span>,
<a class='lineno' href='#line-51' id='line-51'>51</a>     <span class="reference">RECDEF_1</span>,
<a class='lineno' href='#line-52' id='line-52'>52</a>     <span class="reference">FINSET_1</span>,
<a class='lineno' href='#line-53' id='line-53'>53</a>     <span class="reference">ENUMSET1</span>,
<a class='lineno' href='#line-54' id='line-54'>54</a>     <span class="reference">WELLORD2</span>;
<a class='lineno' href='#line-55' id='line-55'>55</a> 
<a class='lineno' href='#line-56' id='line-56'>56</a>   <span class="comment">:: Definition are for automatically unfolding predicates</span>
<a class='lineno' href='#line-57' id='line-57'>57</a>   <span class="comment">::  in the thesis you are proving</span>
<a class='lineno' href='#line-58' id='line-58'>58</a>   <span class="keyword">definitions</span> <span class="reference">TARSKI</span>,
<a class='lineno' href='#line-59' id='line-59'>59</a>     <span class="reference">FUNCT_1</span>, <span class="reference">FUNCT_2</span>,
<a class='lineno' href='#line-60' id='line-60'>60</a>     <span class="reference">FINSEQ_1</span>, <span class="reference">CARD_1</span>, <span class="reference">PBOOLE</span>, <span class="reference">FUNCOP_1</span>,
<a class='lineno' href='#line-61' id='line-61'>61</a>     <span class="reference">ORDERS_1</span>,
<a class='lineno' href='#line-62' id='line-62'>62</a>     <span class="reference">TREES_1</span>, <span class="reference">TREES_2</span>, <span class="reference">TREES_3</span>, <span class="reference">TREES_4</span>,
<a class='lineno' href='#line-63' id='line-63'>63</a>     <span class="comment">::XTUPLE_0;</span>
<a class='lineno' href='#line-64' id='line-64'>64</a>     <span class="reference">MCART_1</span>; <span class="comment">::, FUNCT_5, RECDEF_1;</span>
<a class='lineno' href='#line-65' id='line-65'>65</a> 
<a class='lineno' href='#line-66' id='line-66'>66</a>   <span class="comment">:: Registrations are for clusters (showing that a type exists (is non-empty),</span>
<a class='lineno' href='#line-67' id='line-67'>67</a>   <span class="comment">::  and automatically adding adjectives)</span>
<a class='lineno' href='#line-68' id='line-68'>68</a>   <span class="keyword">registrations</span> <span class="reference">XBOOLE_0</span>, <span class="reference">SUBSET_1</span>, <span class="reference">ORDINAL1</span>, <span class="reference">PARTFUN1</span>,
<a class='lineno' href='#line-69' id='line-69'>69</a>     <span class="comment">::RELAT_2,</span>
<a class='lineno' href='#line-70' id='line-70'>70</a>     <span class="reference">RELAT_1</span>,
<a class='lineno' href='#line-71' id='line-71'>71</a>     <span class="reference">FUNCT_1</span>, <span class="reference">FUNCT_2</span>,
<a class='lineno' href='#line-72' id='line-72'>72</a>     <span class="reference">FUNCOP_1</span>, <span class="reference">XXREAL_0</span>, <span class="reference">XREAL_0</span>, <span class="reference">NAT_1</span>, <span class="reference">FINSEQ_1</span>, <span class="reference">FINSEQ_2</span>, <span class="reference">CARD_1</span>, <span class="reference">RELSET_1</span>,
<a class='lineno' href='#line-73' id='line-73'>73</a>     <span class="reference">PBOOLE</span>, <span class="reference">CARD_3</span>,
<a class='lineno' href='#line-74' id='line-74'>74</a>     <span class="reference">ORDERS_2</span>,
<a class='lineno' href='#line-75' id='line-75'>75</a>     <span class="reference">TREES_1</span>, <span class="reference">TREES_2</span>, <span class="reference">TREES_3</span>, <span class="reference">TREES_4</span>,
<a class='lineno' href='#line-76' id='line-76'>76</a>     <span class="reference">FINSET_1</span>;
<a class='lineno' href='#line-77' id='line-77'>77</a> 
<a class='lineno' href='#line-78' id='line-78'>78</a>   <span class="comment">:: Load theorem en definition labels</span>
<a class='lineno' href='#line-79' id='line-79'>79</a>   <span class="keyword">theorems</span> <span class="reference">FUNCOP_1</span>, <span class="reference">RELAT_1</span>, <span class="reference">TARSKI</span>, <span class="reference">FINSEQ_1</span>, <span class="reference">FINSEQ_2</span>,
<a class='lineno' href='#line-80' id='line-80'>80</a>     <span class="comment">::XTUPLE_0,</span>
<a class='lineno' href='#line-81' id='line-81'>81</a>     <span class="reference">MCART_1</span>, <span class="reference">FUNCT_5</span>, <span class="comment">:: RECDEF_1,</span>
<a class='lineno' href='#line-82' id='line-82'>82</a>     <span class="reference">FUNCT_1</span>,
<a class='lineno' href='#line-83' id='line-83'>83</a>     <span class="reference">TREES_1</span>, <span class="reference">TREES_2</span>, <span class="reference">TREES_3</span>, <span class="reference">TREES_4</span>,
<a class='lineno' href='#line-84' id='line-84'>84</a>     <span class="reference">XBOOLE_0</span>, <span class="reference">SUBSET_1</span>, <span class="reference">RELAT_2</span>, <span class="reference">ENUMSET1</span>,
<a class='lineno' href='#line-85' id='line-85'>85</a>     <span class="reference">CARD_1</span>, <span class="reference">CARD_2</span>, <span class="reference">CARD_3</span>, <span class="reference">CARD_4</span>;
<a class='lineno' href='#line-86' id='line-86'>86</a>   
<a class='lineno' href='#line-87' id='line-87'>87</a>   <span class="keyword">schemes</span> <span class="reference">RECDEF_1</span>, <span class="reference">TREES_2</span>, <span class="reference">TREES_4</span>;
<a class='lineno' href='#line-88' id='line-88'>88</a> 
<a class='lineno' href='#line-89' id='line-89'>89</a>   <span class="keyword">requirements</span> <span class="reference">BOOLE</span>, <span class="reference">SUBSET</span>, <span class="reference">NUMERALS</span>, <span class="reference">ARITHM</span>, <span class="reference">REAL</span>;
<a class='lineno' href='#line-90' id='line-90'>90</a> 
<a class='lineno' href='#line-91' id='line-91'>91</a> <span class="keyword">begin</span></pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-2">
              
                <h2 id="hd-1">
                  
                  <a href="#hd-1" class="headnumber">
                    1
                  </a>
                  
                  Syntax and behaviour
                </h2>
              

              
                <ul class="vocabulary">
                
                
                <li class="type-mode"><a href="#line-96"><code>Variable</code></a></li>
                
                </ul>
              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-3">
              
                
              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-95' id='line-95'>95</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-96' id='line-96'>96</a>   <span class="keyword">mode</span> Variable <span class="keyword">is</span> Element <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-97' id='line-97'>97</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-98' id='line-98'>98</a> 
<a class='lineno' href='#line-99' id='line-99'>99</a> <span class="keyword">reserve</span> T,T1,T2 <span class="keyword">for</span> Tree,
<a class='lineno' href='#line-100' id='line-100'>100</a>         D,D2,E <span class="keyword">for</span> DecoratedTree,
<a class='lineno' href='#line-101' id='line-101'>101</a>         p,q,q0,q1,q2,r,r2 <span class="keyword">for</span> FinSequence <span class="keyword">of</span> NAT,
<a class='lineno' href='#line-102' id='line-102'>102</a>         x,y,z,X,Y,Z <span class="keyword">for</span> set,
<a class='lineno' href='#line-103' id='line-103'>103</a>         i,j,k,l,m,n <span class="keyword">for</span> Element <span class="keyword">of</span> NAT,
<a class='lineno' href='#line-104' id='line-104'>104</a>         u,v,w <span class="keyword">for</span> Variable;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-4">
              
                <h3 id="hd-1.1">
                  
                  <a href="#hd-1.1" class="headnumber">
                    1.1
                  </a>
                  
                  Lambda terms
                </h3>
              

              
                <ul class="vocabulary">
                
                
                <li class="type-attr"><a href="#line-133"><code>LambdaTerm-like</code></a></li>
                
                
                <li class="type-mode"><a href="#line-378"><code>LambdaTerm</code></a></li>
                
                
                <li class="type-func"><a href="#line-384"><code>PreAbstractionTerm</code></a></li>
                
                
                <li class="type-func"><a href="#line-400"><code>PreApplicationTerm</code></a></li>
                
                
                <li class="type-attr"><a href="#line-420"><code>-existingPath</code></a></li>
                
                </ul>
              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-5">
              
                <p>A <em>lambda term</em> is identified with it&#39;s AST (abstract
 syntax tree). More precisely, we identify a lambda term
 with a finite decorated tree.
The nodes of the tree denote either application, abstraction
 or a variable. Using <em>De Bruijn</em> variable indexing, we decorate
 variables with their De Bruijn index (a natural nuber). Note
 that we needn&#39;t explicitly annotate the type of a node,
 as the three types of nodes differ in how many children they must
 have: an application always has two children, an abstraction but one,
 and variables don&#39;t have any. So it suffices to decorate application
 and abstraction nodes with some default value (say, $0$).</p>
<p>In Mizar, a <code>Tree</code> is a non-empty subset of <code>NAT*</code>, so a set of finite
 sequences of natural numbers, such that certain logical properties hold.
Every such sequence denotes a node in the tree, and can be interpreted
 as a <em>path specification</em> (how to get there, from the top). We see, then,
 that lambda term trees are a specific subset of general trees, in which
 only finite sequences of $\{0,1\}$ are used to denote nodes, nodes
 with children are decorated with a $0$, and is also finite in height.
By <em>decorating</em> a node <code>r</code> with a number <code>n</code>, we mean that <code>M.r = n</code>.
Here <code>M</code> is the <code>DecoratedTree of NAT</code> which represents the lambda term.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-130' id='line-130'>130</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-131' id='line-131'>131</a>   <span class="keyword">let</span> D;
<a class='lineno' href='#line-132' id='line-132'>132</a>   
<a class='lineno' href='#line-133' id='line-133'>133</a>   <span class="keyword">attr</span> D <span class="keyword">is</span> LambdaTerm-like <span class="keyword">means</span>
<a class='lineno' href='#line-134' id='line-134'>134</a>     :<span class="reference">Def1</span>:
<a class='lineno' href='#line-135' id='line-135'>135</a>     dom D <span class="keyword">is</span> finite &amp;
<a class='lineno' href='#line-136' id='line-136'>136</a>     <span class="keyword">for</span> r <span class="keyword">st</span> r <span class="keyword">in</span> dom D <span class="keyword">holds</span>
<a class='lineno' href='#line-137' id='line-137'>137</a>       r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} &amp;
<a class='lineno' href='#line-138' id='line-138'>138</a>       ((r^&lt;*0*&gt; <span class="keyword">in</span> dom D &amp; r^&lt;*1*&gt; <span class="keyword">in</span> dom D)
<a class='lineno' href='#line-139' id='line-139'>139</a>           <span class="keyword">implies</span> D.r = 0);
<a class='lineno' href='#line-140' id='line-140'>140</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-6">
              
                <p>Some simple <code>LambdaTerm-like</code> things.</p>
<p>TODO: some more of these simple trees, for easy usage
 later on, when defining application and abstraction.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-147' id='line-147'>147</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-148' id='line-148'>148</a>   <span class="keyword">let</span> v;
<a class='lineno' href='#line-149' id='line-149'>149</a>   
<a class='lineno' href='#line-150' id='line-150'>150</a>   <span class="keyword">cluster</span> { {} } --&gt; v -&gt; LambdaTerm-like;
<a class='lineno' href='#line-151' id='line-151'>151</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-152' id='line-152'>152</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-153' id='line-153'>153</a> <span class="set-keyword">    <span class="keyword">set</span></span> D = { {} } --&gt; v;
<a class='lineno' href='#line-154' id='line-154'>154</a>     dom D = { {} } <span class="keyword">by</span> <span class="reference">FUNCOP_1:13</span>;
<a class='lineno' href='#line-155' id='line-155'>155</a>     <span class="keyword">hence</span> dom D <span class="keyword">is</span> finite;
<a class='lineno' href='#line-156' id='line-156'>156</a>     <span class="keyword">let</span> r <span class="keyword">be</span> FinSequence <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-157' id='line-157'>157</a>     <span class="keyword">assume</span>
<a class='lineno' href='#line-158' id='line-158'>158</a>   A1: r <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-159' id='line-159'>159</a>     dom D = { {} } <span class="keyword">by</span> <span class="reference">FUNCOP_1:13</span>;
<a class='lineno' href='#line-160' id='line-160'>160</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-161' id='line-161'>161</a>   A5: r = {} <span class="keyword">by</span> A1, <span class="reference">TARSKI:def 1</span>;
<a class='lineno' href='#line-162' id='line-162'>162</a>     <span class="keyword">then</span> r = &lt;*&gt; {0,1} <span class="keyword">by</span> <span class="reference">FINSEQ_1:def 6</span>;
<a class='lineno' href='#line-163' id='line-163'>163</a>     <span class="keyword">hence</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1};
<a class='lineno' href='#line-164' id='line-164'>164</a>     <span class="keyword">assume</span> r^&lt;*0*&gt; <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-165' id='line-165'>165</a> <span class="set-keyword">    <span class="keyword">set</span></span> r1 = r^&lt;*1*&gt;;
<a class='lineno' href='#line-166' id='line-166'>166</a>     <span class="keyword">assume</span>
<a class='lineno' href='#line-167' id='line-167'>167</a>   A2: r1 <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-168' id='line-168'>168</a>     <span class="keyword">thus</span> D.r = 0
<a class='lineno' href='#line-169' id='line-169'>169</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-170' id='line-170'>170</a>       <span class="keyword">assume</span> <span class="keyword">not</span> <span class="keyword">thesis</span>;
<a class='lineno' href='#line-171' id='line-171'>171</a>       r1 = {} <span class="keyword">by</span> A2, <span class="reference">TARSKI:def 1</span>;
<a class='lineno' href='#line-172' id='line-172'>172</a>       <span class="keyword">then</span> r1 <span class="keyword">is</span> empty;
<a class='lineno' href='#line-173' id='line-173'>173</a>       <span class="keyword">hence</span> <span class="keyword">contradiction</span>;
<a class='lineno' href='#line-174' id='line-174'>174</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-175' id='line-175'>175</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-176' id='line-176'>176</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-177' id='line-177'>177</a> 
<a class='lineno' href='#line-178' id='line-178'>178</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-179' id='line-179'>179</a>   <span class="keyword">cluster</span> { &lt;*&gt; NAT } -&gt; Tree-like;
<a class='lineno' href='#line-180' id='line-180'>180</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-181' id='line-181'>181</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-182' id='line-182'>182</a>     { &lt;*&gt; NAT } = { {} } <span class="keyword">by</span> <span class="reference">FINSEQ_1:def 6</span>;
<a class='lineno' href='#line-183' id='line-183'>183</a>     <span class="keyword">thus</span> { &lt;*&gt; NAT } <span class="keyword">is</span> Tree-like;
<a class='lineno' href='#line-184' id='line-184'>184</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-185' id='line-185'>185</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-186' id='line-186'>186</a> 
<a class='lineno' href='#line-187' id='line-187'>187</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-188' id='line-188'>188</a>   <span class="keyword">let</span> v;
<a class='lineno' href='#line-189' id='line-189'>189</a>   
<a class='lineno' href='#line-190' id='line-190'>190</a>   <span class="keyword">cluster</span> { &lt;*&gt; NAT } --&gt; v -&gt; LambdaTerm-like;
<a class='lineno' href='#line-191' id='line-191'>191</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-192' id='line-192'>192</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-193' id='line-193'>193</a>     { &lt;*&gt; NAT } = { {} } <span class="keyword">by</span> <span class="reference">FINSEQ_1:def 6</span>;
<a class='lineno' href='#line-194' id='line-194'>194</a>     <span class="keyword">thus</span> { &lt;*&gt; NAT } --&gt; v <span class="keyword">is</span> LambdaTerm-like;
<a class='lineno' href='#line-195' id='line-195'>195</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-196' id='line-196'>196</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-197' id='line-197'>197</a> 
<a class='lineno' href='#line-198' id='line-198'>198</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-199' id='line-199'>199</a>   <span class="keyword">cluster</span> { {}, &lt;*0*&gt; } -&gt; Tree-like;
<a class='lineno' href='#line-200' id='line-200'>200</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-201' id='line-201'>201</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-202' id='line-202'>202</a> <span class="set-keyword">    <span class="keyword">set</span></span> T = { {}, &lt;*0*&gt; };
<a class='lineno' href='#line-203' id='line-203'>203</a>     T = elementary_tree 1 <span class="keyword">by</span> <span class="reference">TREES_1:51</span>;
<a class='lineno' href='#line-204' id='line-204'>204</a>     <span class="keyword">then</span> <span class="keyword">reconsider</span> T <span class="keyword">as</span> Tree;
<a class='lineno' href='#line-205' id='line-205'>205</a>     T <span class="keyword">is</span> Tree-like;
<a class='lineno' href='#line-206' id='line-206'>206</a>     <span class="keyword">hence</span> { {}, &lt;*0*&gt; } <span class="keyword">is</span> Tree-like;
<a class='lineno' href='#line-207' id='line-207'>207</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-208' id='line-208'>208</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-209' id='line-209'>209</a> 
<a class='lineno' href='#line-210' id='line-210'>210</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-211' id='line-211'>211</a>   <span class="keyword">let</span> v;
<a class='lineno' href='#line-212' id='line-212'>212</a> 
<a class='lineno' href='#line-213' id='line-213'>213</a>   <span class="keyword">cluster</span> { {}, &lt;*0*&gt; } --&gt; v -&gt; LambdaTerm-like;
<a class='lineno' href='#line-214' id='line-214'>214</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-215' id='line-215'>215</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-216' id='line-216'>216</a> <span class="set-keyword">    <span class="keyword">set</span></span> T = { {}, &lt;*0*&gt; };
<a class='lineno' href='#line-217' id='line-217'>217</a>   A6: T <span class="keyword">is</span> finite;
<a class='lineno' href='#line-218' id='line-218'>218</a> <span class="set-keyword">    <span class="keyword">set</span></span> D = T --&gt; v;
<a class='lineno' href='#line-219' id='line-219'>219</a>   A2: dom D = T <span class="keyword">by</span> <span class="reference">FUNCOP_1:13</span>;
<a class='lineno' href='#line-220' id='line-220'>220</a>     <span class="keyword">hence</span> dom D <span class="keyword">is</span> finite <span class="keyword">by</span> A6;
<a class='lineno' href='#line-221' id='line-221'>221</a>     <span class="keyword">reconsider</span> T <span class="keyword">as</span> Tree;
<a class='lineno' href='#line-222' id='line-222'>222</a>     <span class="keyword">let</span> r <span class="keyword">be</span> FinSequence <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-223' id='line-223'>223</a>     <span class="keyword">assume</span>
<a class='lineno' href='#line-224' id='line-224'>224</a>   A1: r <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-225' id='line-225'>225</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-226' id='line-226'>226</a>   A3: r = {} <span class="keyword">or</span> r = &lt;*0*&gt; <span class="keyword">by</span> A1, A2, <span class="reference">TARSKI:def 2</span>;
<a class='lineno' href='#line-227' id='line-227'>227</a>     <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-228' id='line-228'>228</a>     <span class="keyword">suppose</span>
<a class='lineno' href='#line-229' id='line-229'>229</a>     A7: r = {};
<a class='lineno' href='#line-230' id='line-230'>230</a>       <span class="keyword">then</span> r = &lt;*&gt; {0,1} <span class="keyword">by</span> <span class="reference">FINSEQ_1:def 6</span>;
<a class='lineno' href='#line-231' id='line-231'>231</a>       <span class="keyword">hence</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1};
<a class='lineno' href='#line-232' id='line-232'>232</a>       <span class="keyword">assume</span> r^&lt;*0*&gt; <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-233' id='line-233'>233</a> <span class="set-keyword">      <span class="keyword">set</span></span> r1 = r^&lt;*1*&gt;;
<a class='lineno' href='#line-234' id='line-234'>234</a>       <span class="keyword">assume</span>
<a class='lineno' href='#line-235' id='line-235'>235</a>     A9: r1 <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-236' id='line-236'>236</a>       <span class="keyword">thus</span> D.r = 0
<a class='lineno' href='#line-237' id='line-237'>237</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-238' id='line-238'>238</a>         <span class="keyword">assume</span> <span class="keyword">not</span> <span class="keyword">thesis</span>;
<a class='lineno' href='#line-239' id='line-239'>239</a>       A8: r1 = &lt;*1*&gt; <span class="keyword">by</span> A7, <span class="reference">FINSEQ_1:34</span>;
<a class='lineno' href='#line-240' id='line-240'>240</a>         <span class="keyword">then</span> r1 <span class="keyword">is</span> non empty;
<a class='lineno' href='#line-241' id='line-241'>241</a>         <span class="keyword">then</span>
<a class='lineno' href='#line-242' id='line-242'>242</a>       A11: <span class="keyword">not</span> r1 <span class="keyword">is</span> empty;
<a class='lineno' href='#line-243' id='line-243'>243</a>       A10: r1 = {} <span class="keyword">or</span> r1 = &lt;*0*&gt; <span class="keyword">by</span> A1, A2, A9, <span class="reference">TARSKI:def 2</span>;
<a class='lineno' href='#line-244' id='line-244'>244</a>         <span class="keyword">not</span> r1 = {}
<a class='lineno' href='#line-245' id='line-245'>245</a>         <span class="keyword">proof</span>
<a class='lineno' href='#line-246' id='line-246'>246</a>           <span class="keyword">assume</span> r1 = {};
<a class='lineno' href='#line-247' id='line-247'>247</a>           <span class="keyword">then</span> r1 <span class="keyword">is</span> empty;
<a class='lineno' href='#line-248' id='line-248'>248</a>           <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A11;
<a class='lineno' href='#line-249' id='line-249'>249</a>         <span class="keyword">end</span>;
<a class='lineno' href='#line-250' id='line-250'>250</a>         <span class="keyword">then</span> r1 = &lt;*0*&gt; <span class="keyword">by</span> A10;
<a class='lineno' href='#line-251' id='line-251'>251</a>         <span class="keyword">then</span>
<a class='lineno' href='#line-252' id='line-252'>252</a>       A12: r1.1 = 0 <span class="keyword">by</span> <span class="reference">FINSEQ_1:40</span>;
<a class='lineno' href='#line-253' id='line-253'>253</a>         r1.1 = 1 <span class="keyword">by</span> A8, <span class="reference">FINSEQ_1:40</span>;
<a class='lineno' href='#line-254' id='line-254'>254</a>         <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A12;
<a class='lineno' href='#line-255' id='line-255'>255</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-256' id='line-256'>256</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-257' id='line-257'>257</a>     <span class="keyword">suppose</span>
<a class='lineno' href='#line-258' id='line-258'>258</a>     A5: <span class="keyword">not</span> r = {};
<a class='lineno' href='#line-259' id='line-259'>259</a> <span class="set-keyword">      <span class="keyword">set</span></span> ZeroOne = {0,1};
<a class='lineno' href='#line-260' id='line-260'>260</a>       <span class="keyword">reconsider</span> ZeroOne <span class="keyword">as</span> non empty set;
<a class='lineno' href='#line-261' id='line-261'>261</a> <span class="set-keyword">      <span class="keyword">set</span></span> Zero = 0;
<a class='lineno' href='#line-262' id='line-262'>262</a>       Zero <span class="keyword">in</span> {0,1} <span class="keyword">by</span> <span class="reference">TARSKI:def 2</span>;
<a class='lineno' href='#line-263' id='line-263'>263</a>       <span class="keyword">then</span> <span class="keyword">reconsider</span> Zero <span class="keyword">as</span> Element <span class="keyword">of</span> ZeroOne;
<a class='lineno' href='#line-264' id='line-264'>264</a>     A4: &lt;*Zero*&gt; <span class="keyword">is</span> FinSequence <span class="keyword">of</span> ZeroOne;
<a class='lineno' href='#line-265' id='line-265'>265</a>     A18: r = &lt;*0*&gt; <span class="keyword">by</span> A3, A5
<a class='lineno' href='#line-266' id='line-266'>266</a>        .= &lt;*Zero*&gt;;
<a class='lineno' href='#line-267' id='line-267'>267</a>       <span class="keyword">hence</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> A4;
<a class='lineno' href='#line-268' id='line-268'>268</a>       <span class="keyword">assume</span> r^&lt;*0*&gt; <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-269' id='line-269'>269</a> <span class="set-keyword">      <span class="keyword">set</span></span> r1 = r^&lt;*1*&gt;;
<a class='lineno' href='#line-270' id='line-270'>270</a>       <span class="keyword">assume</span>
<a class='lineno' href='#line-271' id='line-271'>271</a>     A13: r1 <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-272' id='line-272'>272</a>       <span class="keyword">thus</span> D.r = 0
<a class='lineno' href='#line-273' id='line-273'>273</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-274' id='line-274'>274</a>         <span class="keyword">assume</span> <span class="keyword">not</span> <span class="keyword">thesis</span>;
<a class='lineno' href='#line-275' id='line-275'>275</a>       A14: r1 = &lt;*0,1*&gt; <span class="keyword">by</span> A18, A4, <span class="reference">FINSEQ_1:def 9</span>;
<a class='lineno' href='#line-276' id='line-276'>276</a>         <span class="keyword">then</span> r1 <span class="keyword">is</span> non empty;
<a class='lineno' href='#line-277' id='line-277'>277</a>         <span class="keyword">then</span>
<a class='lineno' href='#line-278' id='line-278'>278</a>       A15: <span class="keyword">not</span> r1 <span class="keyword">is</span> empty;
<a class='lineno' href='#line-279' id='line-279'>279</a>       A16: r1 = {} <span class="keyword">or</span> r1 = &lt;*0*&gt; <span class="keyword">by</span> A1, A2, A13, <span class="reference">TARSKI:def 2</span>;
<a class='lineno' href='#line-280' id='line-280'>280</a>         <span class="keyword">not</span> r1 = {}
<a class='lineno' href='#line-281' id='line-281'>281</a>         <span class="keyword">proof</span>
<a class='lineno' href='#line-282' id='line-282'>282</a>           <span class="keyword">assume</span> r1 = {};
<a class='lineno' href='#line-283' id='line-283'>283</a>           <span class="keyword">then</span> r1 <span class="keyword">is</span> empty;
<a class='lineno' href='#line-284' id='line-284'>284</a>           <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A15;
<a class='lineno' href='#line-285' id='line-285'>285</a>         <span class="keyword">end</span>;
<a class='lineno' href='#line-286' id='line-286'>286</a>         <span class="keyword">then</span> r1 = &lt;*0*&gt; <span class="keyword">by</span> A16;
<a class='lineno' href='#line-287' id='line-287'>287</a>         <span class="keyword">then</span>
<a class='lineno' href='#line-288' id='line-288'>288</a>       A17: len r1 = 1 <span class="keyword">by</span> <span class="reference">FINSEQ_1:40</span>;
<a class='lineno' href='#line-289' id='line-289'>289</a>         len r1 = 2 <span class="keyword">by</span> A14, <span class="reference">FINSEQ_1:44</span>;
<a class='lineno' href='#line-290' id='line-290'>290</a>         <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A17;
<a class='lineno' href='#line-291' id='line-291'>291</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-292' id='line-292'>292</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-293' id='line-293'>293</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-294' id='line-294'>294</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-295' id='line-295'>295</a> 
<a class='lineno' href='#line-296' id='line-296'>296</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-297' id='line-297'>297</a>   <span class="keyword">cluster</span> { {}, &lt;*0*&gt;, &lt;*1*&gt; } -&gt; Tree-like;
<a class='lineno' href='#line-298' id='line-298'>298</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-299' id='line-299'>299</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-300' id='line-300'>300</a> <span class="set-keyword">    <span class="keyword">set</span></span> T = { {}, &lt;*0*&gt;, &lt;*1*&gt; };
<a class='lineno' href='#line-301' id='line-301'>301</a>     T = elementary_tree 2 <span class="keyword">by</span> <span class="reference">TREES_1:53</span>;
<a class='lineno' href='#line-302' id='line-302'>302</a>     <span class="keyword">then</span> <span class="keyword">reconsider</span> T <span class="keyword">as</span> Tree;
<a class='lineno' href='#line-303' id='line-303'>303</a>     T <span class="keyword">is</span> Tree-like;
<a class='lineno' href='#line-304' id='line-304'>304</a>     <span class="keyword">hence</span> { {}, &lt;*0*&gt;, &lt;*1*&gt; } <span class="keyword">is</span> Tree-like;
<a class='lineno' href='#line-305' id='line-305'>305</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-306' id='line-306'>306</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-307' id='line-307'>307</a> 
<a class='lineno' href='#line-308' id='line-308'>308</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-309' id='line-309'>309</a>   <span class="keyword">cluster</span> { {}, &lt;*0*&gt;, &lt;*1*&gt; } --&gt; 0 -&gt; LambdaTerm-like;
<a class='lineno' href='#line-310' id='line-310'>310</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-311' id='line-311'>311</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-312' id='line-312'>312</a> <span class="set-keyword">    <span class="keyword">set</span></span> T = { {}, &lt;*0*&gt;, &lt;*1*&gt; };
<a class='lineno' href='#line-313' id='line-313'>313</a>   A6: T <span class="keyword">is</span> finite;
<a class='lineno' href='#line-314' id='line-314'>314</a> <span class="set-keyword">    <span class="keyword">set</span></span> D = T --&gt; 0;
<a class='lineno' href='#line-315' id='line-315'>315</a>   A2: dom D = T <span class="keyword">by</span> <span class="reference">FUNCOP_1:13</span>;
<a class='lineno' href='#line-316' id='line-316'>316</a>     <span class="keyword">hence</span> dom D <span class="keyword">is</span> finite <span class="keyword">by</span> A6;
<a class='lineno' href='#line-317' id='line-317'>317</a>     <span class="keyword">reconsider</span> T <span class="keyword">as</span> Tree;
<a class='lineno' href='#line-318' id='line-318'>318</a>     <span class="keyword">let</span> r <span class="keyword">be</span> FinSequence <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-319' id='line-319'>319</a>     <span class="keyword">assume</span>
<a class='lineno' href='#line-320' id='line-320'>320</a>   A1: r <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-321' id='line-321'>321</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-322' id='line-322'>322</a>   A3: r = {} <span class="keyword">or</span> r = &lt;*0*&gt; <span class="keyword">or</span> r = &lt;*1*&gt; <span class="keyword">by</span> A1, A2, <span class="reference">ENUMSET1:def 1</span>;
<a class='lineno' href='#line-323' id='line-323'>323</a>     <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-324' id='line-324'>324</a>     <span class="keyword">suppose</span> r = {};
<a class='lineno' href='#line-325' id='line-325'>325</a>       <span class="keyword">then</span> r = &lt;*&gt; {0,1} <span class="keyword">by</span> <span class="reference">FINSEQ_1:def 6</span>;
<a class='lineno' href='#line-326' id='line-326'>326</a>       <span class="keyword">hence</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1};
<a class='lineno' href='#line-327' id='line-327'>327</a>       <span class="keyword">assume</span> r^&lt;*0*&gt; <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-328' id='line-328'>328</a>       <span class="keyword">assume</span> r^&lt;*1*&gt; <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-329' id='line-329'>329</a>       <span class="keyword">thus</span> D.r = 0 <span class="keyword">by</span> A1, <span class="reference">FUNCOP_1:7</span>;
<a class='lineno' href='#line-330' id='line-330'>330</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-331' id='line-331'>331</a>     <span class="keyword">suppose</span>
<a class='lineno' href='#line-332' id='line-332'>332</a>     A5: r = &lt;*0*&gt;;
<a class='lineno' href='#line-333' id='line-333'>333</a> <span class="set-keyword">      <span class="keyword">set</span></span> ZeroOne = {0,1};
<a class='lineno' href='#line-334' id='line-334'>334</a>       <span class="keyword">reconsider</span> ZeroOne <span class="keyword">as</span> non empty set;
<a class='lineno' href='#line-335' id='line-335'>335</a> <span class="set-keyword">      <span class="keyword">set</span></span> Zero = 0;
<a class='lineno' href='#line-336' id='line-336'>336</a>       Zero <span class="keyword">in</span> {0,1} <span class="keyword">by</span> <span class="reference">TARSKI:def 2</span>;
<a class='lineno' href='#line-337' id='line-337'>337</a>       <span class="keyword">then</span> <span class="keyword">reconsider</span> Zero <span class="keyword">as</span> Element <span class="keyword">of</span> ZeroOne;
<a class='lineno' href='#line-338' id='line-338'>338</a>     A4: &lt;*Zero*&gt; <span class="keyword">is</span> FinSequence <span class="keyword">of</span> ZeroOne;
<a class='lineno' href='#line-339' id='line-339'>339</a>       r = &lt;*0*&gt; <span class="keyword">by</span> A5
<a class='lineno' href='#line-340' id='line-340'>340</a>        .= &lt;*Zero*&gt;;
<a class='lineno' href='#line-341' id='line-341'>341</a>       <span class="keyword">hence</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> A4;
<a class='lineno' href='#line-342' id='line-342'>342</a>       <span class="keyword">assume</span> r^&lt;*0*&gt; <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-343' id='line-343'>343</a>       <span class="keyword">assume</span> r^&lt;*1*&gt; <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-344' id='line-344'>344</a>       <span class="keyword">thus</span> D.r = 0 <span class="keyword">by</span> A1, <span class="reference">FUNCOP_1:7</span>;
<a class='lineno' href='#line-345' id='line-345'>345</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-346' id='line-346'>346</a>     <span class="keyword">suppose</span> <span class="keyword">not</span> (r = {} <span class="keyword">or</span> r = &lt;*0*&gt;);
<a class='lineno' href='#line-347' id='line-347'>347</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-348' id='line-348'>348</a>     A7: r = &lt;*1*&gt; <span class="keyword">by</span> A3;
<a class='lineno' href='#line-349' id='line-349'>349</a> <span class="set-keyword">      <span class="keyword">set</span></span> ZeroOne = {0,1};
<a class='lineno' href='#line-350' id='line-350'>350</a>       <span class="keyword">reconsider</span> ZeroOne <span class="keyword">as</span> non empty set;
<a class='lineno' href='#line-351' id='line-351'>351</a> <span class="set-keyword">      <span class="keyword">set</span></span> One = 1;
<a class='lineno' href='#line-352' id='line-352'>352</a>       One <span class="keyword">in</span> {0,1} <span class="keyword">by</span> <span class="reference">TARSKI:def 2</span>;
<a class='lineno' href='#line-353' id='line-353'>353</a>       <span class="keyword">then</span> <span class="keyword">reconsider</span> One <span class="keyword">as</span> Element <span class="keyword">of</span> ZeroOne;
<a class='lineno' href='#line-354' id='line-354'>354</a>     A4: &lt;*One*&gt; <span class="keyword">is</span> FinSequence <span class="keyword">of</span> ZeroOne;
<a class='lineno' href='#line-355' id='line-355'>355</a>       r = &lt;*1*&gt; <span class="keyword">by</span> A7
<a class='lineno' href='#line-356' id='line-356'>356</a>        .= &lt;*One*&gt;;
<a class='lineno' href='#line-357' id='line-357'>357</a>       <span class="keyword">hence</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1};
<a class='lineno' href='#line-358' id='line-358'>358</a>       <span class="keyword">assume</span> r^&lt;*0*&gt; <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-359' id='line-359'>359</a>       <span class="keyword">assume</span> r^&lt;*1*&gt; <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-360' id='line-360'>360</a>       <span class="keyword">thus</span> D.r = 0 <span class="keyword">by</span> A1, <span class="reference">FUNCOP_1:7</span>;
<a class='lineno' href='#line-361' id='line-361'>361</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-362' id='line-362'>362</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-363' id='line-363'>363</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-7">
              
                <p>And then we can easily define a <code>LambdaTerm-like</code> cluster,
 and make a mode <code>LambdaTerm</code> out of it.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-367' id='line-367'>367</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-368' id='line-368'>368</a>   <span class="keyword">cluster</span> LambdaTerm-like <span class="keyword">for</span> DecoratedTree <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-369' id='line-369'>369</a>   <span class="keyword">existence</span>
<a class='lineno' href='#line-370' id='line-370'>370</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-371' id='line-371'>371</a> <span class="set-keyword">    <span class="keyword">set</span></span> D = { {} } --&gt; 0;
<a class='lineno' href='#line-372' id='line-372'>372</a>     <span class="keyword">take</span> D;
<a class='lineno' href='#line-373' id='line-373'>373</a>     <span class="keyword">thus</span> D <span class="keyword">is</span> LambdaTerm-like;
<a class='lineno' href='#line-374' id='line-374'>374</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-375' id='line-375'>375</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-376' id='line-376'>376</a> 
<a class='lineno' href='#line-377' id='line-377'>377</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-378' id='line-378'>378</a>   <span class="keyword">mode</span> LambdaTerm <span class="keyword">is</span> LambdaTerm-like DecoratedTree <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-379' id='line-379'>379</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-380' id='line-380'>380</a> 
<a class='lineno' href='#line-381' id='line-381'>381</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-382' id='line-382'>382</a>   <span class="keyword">let</span> v;
<a class='lineno' href='#line-383' id='line-383'>383</a> 
<a class='lineno' href='#line-384' id='line-384'>384</a>   <span class="keyword">func</span> PreAbstractionTerm v -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-385' id='line-385'>385</a>     { {}, &lt;*0*&gt; } --&gt; v;
<a class='lineno' href='#line-386' id='line-386'>386</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-387' id='line-387'>387</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-388' id='line-388'>388</a> <span class="set-keyword">    <span class="keyword">set</span></span> T = { {}, &lt;*0*&gt; };
<a class='lineno' href='#line-389' id='line-389'>389</a>     <span class="keyword">reconsider</span> T <span class="keyword">as</span> Tree;
<a class='lineno' href='#line-390' id='line-390'>390</a> <span class="set-keyword">    <span class="keyword">set</span></span> D = T --&gt; v;
<a class='lineno' href='#line-391' id='line-391'>391</a>     <span class="keyword">reconsider</span> D <span class="keyword">as</span> DecoratedTree <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-392' id='line-392'>392</a>     D <span class="keyword">is</span> LambdaTerm-like;
<a class='lineno' href='#line-393' id='line-393'>393</a>     <span class="keyword">then</span> <span class="keyword">reconsider</span> D <span class="keyword">as</span> LambdaTerm;
<a class='lineno' href='#line-394' id='line-394'>394</a>     D <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-395' id='line-395'>395</a>     <span class="keyword">hence</span> { {}, &lt;*0*&gt; } --&gt; v <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-396' id='line-396'>396</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-397' id='line-397'>397</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-398' id='line-398'>398</a> 
<a class='lineno' href='#line-399' id='line-399'>399</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-400' id='line-400'>400</a>   <span class="keyword">func</span> PreApplicationTerm -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-401' id='line-401'>401</a>     { {}, &lt;*0*&gt;, &lt;*1*&gt; } --&gt; 0;
<a class='lineno' href='#line-402' id='line-402'>402</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-403' id='line-403'>403</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-404' id='line-404'>404</a> <span class="set-keyword">    <span class="keyword">set</span></span> T = { {}, &lt;*0*&gt;, &lt;*1*&gt; };
<a class='lineno' href='#line-405' id='line-405'>405</a>     <span class="keyword">reconsider</span> T <span class="keyword">as</span> Tree;
<a class='lineno' href='#line-406' id='line-406'>406</a> <span class="set-keyword">    <span class="keyword">set</span></span> D = T --&gt; 0;
<a class='lineno' href='#line-407' id='line-407'>407</a>     <span class="keyword">reconsider</span> D <span class="keyword">as</span> DecoratedTree <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-408' id='line-408'>408</a>     D <span class="keyword">is</span> LambdaTerm-like;
<a class='lineno' href='#line-409' id='line-409'>409</a>     <span class="keyword">then</span> <span class="keyword">reconsider</span> D <span class="keyword">as</span> LambdaTerm;
<a class='lineno' href='#line-410' id='line-410'>410</a>     D <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-411' id='line-411'>411</a>     <span class="keyword">hence</span> { {}, &lt;*0*&gt;, &lt;*1*&gt; } --&gt; 0 <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-412' id='line-412'>412</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-413' id='line-413'>413</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-414' id='line-414'>414</a> 
<a class='lineno' href='#line-415' id='line-415'>415</a> <span class="keyword">reserve</span> M,N,P,Q <span class="keyword">for</span> LambdaTerm;
<a class='lineno' href='#line-416' id='line-416'>416</a> 
<a class='lineno' href='#line-417' id='line-417'>417</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-418' id='line-418'>418</a>   <span class="keyword">let</span> M,r;
<a class='lineno' href='#line-419' id='line-419'>419</a> 
<a class='lineno' href='#line-420' id='line-420'>420</a>   <span class="keyword">attr</span> r <span class="keyword">is</span> M-existingPath <span class="keyword">means</span>
<a class='lineno' href='#line-421' id='line-421'>421</a>     :<span class="reference">Def18</span>:
<a class='lineno' href='#line-422' id='line-422'>422</a>     r <span class="keyword">is</span> Element <span class="keyword">of</span> dom M;
<a class='lineno' href='#line-423' id='line-423'>423</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-8">
              
                <h4 id="hd-1.1.1">
                  
                  <a href="#hd-1.1.1" class="headnumber">
                    1.1.1
                  </a>
                  
                  Preservation under operations
                </h4>
              

              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-9">
              
                <p><code>LambdaTerm</code>s are preserved under taking subterms, and composing
 terms. We&#39;ll register this knowledge in the type system.</p>
<p>Let Mizar know that <code>M|r</code> is also a <code>LambdaTerm</code>.
The definition of <code>|</code> that we are using is the definition
 that operates on (and returns) a <code>DecoratedTree</code>. Showing
 that retricting a <code>LambdaTerm</code> produces a <code>LambdaTerm-like</code>
 result ensures us that the result is a <code>LambdaTerm</code>.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-435' id='line-435'>435</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-436' id='line-436'>436</a>   <span class="keyword">let</span> M <span class="keyword">be</span> LambdaTerm,
<a class='lineno' href='#line-437' id='line-437'>437</a>       r <span class="keyword">be</span> Element <span class="keyword">of</span> dom M;
<a class='lineno' href='#line-438' id='line-438'>438</a> 
<a class='lineno' href='#line-439' id='line-439'>439</a>   <span class="keyword">cluster</span> M|r -&gt; LambdaTerm-like;
<a class='lineno' href='#line-440' id='line-440'>440</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-441' id='line-441'>441</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-442' id='line-442'>442</a>     <span class="keyword">thus</span> dom (M|r) <span class="keyword">is</span> finite <span class="keyword">proof</span>
<a class='lineno' href='#line-443' id='line-443'>443</a>       dom M <span class="keyword">is</span> finite <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-444' id='line-444'>444</a>       <span class="keyword">then</span> (dom M)|r <span class="keyword">is</span> finite;
<a class='lineno' href='#line-445' id='line-445'>445</a>       <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-446' id='line-446'>446</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-447' id='line-447'>447</a> 
<a class='lineno' href='#line-448' id='line-448'>448</a>     <span class="keyword">let</span> p <span class="keyword">be</span> FinSequence <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-449' id='line-449'>449</a>     <span class="keyword">assume</span>
<a class='lineno' href='#line-450' id='line-450'>450</a>   A3: p <span class="keyword">in</span> dom (M|r);
<a class='lineno' href='#line-451' id='line-451'>451</a>     <span class="keyword">thus</span> p <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">proof</span>
<a class='lineno' href='#line-452' id='line-452'>452</a>       dom (M|r) = (dom M)|r <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-453' id='line-453'>453</a>       <span class="keyword">then</span> p <span class="keyword">in</span> (dom M)|r <span class="keyword">by</span> A3;
<a class='lineno' href='#line-454' id='line-454'>454</a>       <span class="keyword">then</span> r^p <span class="keyword">in</span> dom M <span class="keyword">by</span> <span class="reference">TREES_1:def 6</span>;
<a class='lineno' href='#line-455' id='line-455'>455</a>       <span class="keyword">then</span> r^p <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-456' id='line-456'>456</a>       <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> <span class="reference">FINSEQ_1:36</span>;
<a class='lineno' href='#line-457' id='line-457'>457</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-458' id='line-458'>458</a> 
<a class='lineno' href='#line-459' id='line-459'>459</a>     <span class="comment">:: r^p^&lt;*0*&gt;</span>
<a class='lineno' href='#line-460' id='line-460'>460</a> <span class="set-keyword">    <span class="keyword">set</span></span> p0 = p^&lt;*0*&gt;;
<a class='lineno' href='#line-461' id='line-461'>461</a> <span class="set-keyword">    <span class="keyword">set</span></span> p1 = p^&lt;*1*&gt;;
<a class='lineno' href='#line-462' id='line-462'>462</a> <span class="set-keyword">    <span class="keyword">set</span></span> rp = r^p;
<a class='lineno' href='#line-463' id='line-463'>463</a>     <span class="keyword">assume</span>
<a class='lineno' href='#line-464' id='line-464'>464</a>   A4: p0 <span class="keyword">in</span> dom (M|r);
<a class='lineno' href='#line-465' id='line-465'>465</a>     <span class="keyword">assume</span>
<a class='lineno' href='#line-466' id='line-466'>466</a>   A9: p1 <span class="keyword">in</span> dom (M|r);
<a class='lineno' href='#line-467' id='line-467'>467</a>     <span class="keyword">thus</span> (M|r).p = 0 <span class="keyword">proof</span>
<a class='lineno' href='#line-468' id='line-468'>468</a>     A6: rp^&lt;*0*&gt; <span class="keyword">in</span> dom M
<a class='lineno' href='#line-469' id='line-469'>469</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-470' id='line-470'>470</a>         dom (M|r) <span class="keyword">is</span> Tree-like;
<a class='lineno' href='#line-471' id='line-471'>471</a>         <span class="keyword">then</span> p0 <span class="keyword">in</span> dom (M|r) <span class="keyword">by</span> A4, <span class="reference">TREES_1:21</span>;
<a class='lineno' href='#line-472' id='line-472'>472</a>         <span class="keyword">then</span> <span class="keyword">reconsider</span> p0 <span class="keyword">as</span> Element <span class="keyword">of</span> dom (M|r);
<a class='lineno' href='#line-473' id='line-473'>473</a>         <span class="keyword">reconsider</span> p0 <span class="keyword">as</span> Element <span class="keyword">of</span> (dom M)|r <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-474' id='line-474'>474</a>         p0 <span class="keyword">in</span> (dom M)|r;
<a class='lineno' href='#line-475' id='line-475'>475</a>         <span class="keyword">then</span> r^p0 <span class="keyword">in</span> dom M <span class="keyword">by</span> <span class="reference">TREES_1:def 6</span>;
<a class='lineno' href='#line-476' id='line-476'>476</a>         <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> <span class="reference">FINSEQ_1:32</span>;
<a class='lineno' href='#line-477' id='line-477'>477</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-478' id='line-478'>478</a>     A7: rp^&lt;*1*&gt; <span class="keyword">in</span> dom M
<a class='lineno' href='#line-479' id='line-479'>479</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-480' id='line-480'>480</a>         dom (M|r) <span class="keyword">is</span> Tree-like;
<a class='lineno' href='#line-481' id='line-481'>481</a>         <span class="keyword">then</span> p1 <span class="keyword">in</span> dom (M|r) <span class="keyword">by</span> A9, <span class="reference">TREES_1:21</span>;
<a class='lineno' href='#line-482' id='line-482'>482</a>         <span class="keyword">then</span> <span class="keyword">reconsider</span> p1 <span class="keyword">as</span> Element <span class="keyword">of</span> dom (M|r);
<a class='lineno' href='#line-483' id='line-483'>483</a>         <span class="keyword">reconsider</span> p1 <span class="keyword">as</span> Element <span class="keyword">of</span> (dom M)|r <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-484' id='line-484'>484</a>         p1 <span class="keyword">in</span> (dom M)|r;
<a class='lineno' href='#line-485' id='line-485'>485</a>         <span class="keyword">then</span> r^p1 <span class="keyword">in</span> dom M <span class="keyword">by</span> <span class="reference">TREES_1:def 6</span>;
<a class='lineno' href='#line-486' id='line-486'>486</a>         <span class="keyword">then</span> rp^&lt;*1*&gt; <span class="keyword">in</span> dom M <span class="keyword">by</span> <span class="reference">FINSEQ_1:32</span>;
<a class='lineno' href='#line-487' id='line-487'>487</a>         <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> <span class="reference">FINSEQ_1:32</span>;
<a class='lineno' href='#line-488' id='line-488'>488</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-489' id='line-489'>489</a>       rp <span class="keyword">in</span> dom M <span class="keyword">by</span> <span class="reference">TREES_1:21</span>, A6, A7;
<a class='lineno' href='#line-490' id='line-490'>490</a>       <span class="keyword">then</span> M.rp = 0 <span class="keyword">by</span> A6, A7, <span class="reference">Def1</span>;
<a class='lineno' href='#line-491' id='line-491'>491</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-492' id='line-492'>492</a>     A8: M.(r^p) = 0;
<a class='lineno' href='#line-493' id='line-493'>493</a>       p <span class="keyword">in</span> (dom M)|r <span class="keyword">by</span> A3, <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-494' id='line-494'>494</a>       <span class="keyword">then</span> (M|r).p = M.(r^p) <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-495' id='line-495'>495</a>       <span class="keyword">hence</span> (M|r).p = 0 <span class="keyword">by</span> A8, <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-496' id='line-496'>496</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-497' id='line-497'>497</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-498' id='line-498'>498</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-10">
              
                <p>Let Mizar know that <code>P with-replacement (p,Q)</code> is also a <code>LambdaTerm</code>.
First we prove a slightly more general theorem about the ranges of
 composed <code>DecoratedTree</code>s, and add this knowledge to the type system.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-503' id='line-503'>503</a> <span class="keyword">reserve</span> X <span class="keyword">for</span> set,
<a class='lineno' href='#line-504' id='line-504'>504</a>         D1,D2 <span class="keyword">for</span> DecoratedTree,
<a class='lineno' href='#line-505' id='line-505'>505</a>         p <span class="keyword">for</span> Element <span class="keyword">of</span> dom D1;
<a class='lineno' href='#line-506' id='line-506'>506</a> 
<a class='lineno' href='#line-507' id='line-507'>507</a> <span class="keyword">theorem</span> Th1:
<a class='lineno' href='#line-508' id='line-508'>508</a>   D1 <span class="keyword">is</span> X-valued &amp; D2 <span class="keyword">is</span> Y-valued <span class="keyword">implies</span>
<a class='lineno' href='#line-509' id='line-509'>509</a>     D1 with-replacement (p,D2) <span class="keyword">is</span> (X \/ Y)-valued
<a class='lineno' href='#line-510' id='line-510'>510</a> <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-511' id='line-511'>511</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-512' id='line-512'>512</a> A4: D1 <span class="keyword">is</span> X-valued;
<a class='lineno' href='#line-513' id='line-513'>513</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-514' id='line-514'>514</a> A5: D2 <span class="keyword">is</span> Y-valued;
<a class='lineno' href='#line-515' id='line-515'>515</a> <span class="set-keyword">  <span class="keyword">set</span></span> D = D1 with-replacement (p,D2);
<a class='lineno' href='#line-516' id='line-516'>516</a> <span class="set-keyword">  <span class="keyword">set</span></span> T = dom D;
<a class='lineno' href='#line-517' id='line-517'>517</a>   rng D c= X \/ Y
<a class='lineno' href='#line-518' id='line-518'>518</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-519' id='line-519'>519</a>     <span class="keyword">let</span> x <span class="keyword">be</span> set;
<a class='lineno' href='#line-520' id='line-520'>520</a>     <span class="keyword">assume</span> x <span class="keyword">in</span> rng D;
<a class='lineno' href='#line-521' id='line-521'>521</a>     <span class="keyword">then</span> <span class="keyword">ex</span> q <span class="keyword">being</span> set <span class="keyword">st</span> [q,x] <span class="keyword">in</span> D <span class="keyword">by</span> <span class="reference">RELAT_1:def 5</span>;
<a class='lineno' href='#line-522' id='line-522'>522</a>     <span class="keyword">then</span> <span class="keyword">consider</span> q <span class="keyword">being</span> set <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-523' id='line-523'>523</a>   A1: [q,x] <span class="keyword">in</span> D;
<a class='lineno' href='#line-524' id='line-524'>524</a>   A2: q <span class="keyword">in</span> T <span class="keyword">by</span> A1, <span class="reference">RELAT_1:def 4</span>;
<a class='lineno' href='#line-525' id='line-525'>525</a>     T <span class="keyword">is</span> Tree <span class="keyword">by</span> <span class="reference">TREES_2:def 8</span>;
<a class='lineno' href='#line-526' id='line-526'>526</a>     <span class="keyword">then</span> <span class="keyword">reconsider</span> q <span class="keyword">as</span> FinSequence <span class="keyword">of</span> NAT <span class="keyword">by</span> A2, <span class="reference">TREES_1:19</span>;
<a class='lineno' href='#line-527' id='line-527'>527</a>   A13: T = dom D1 with-replacement (p, dom D2) <span class="keyword">by</span> <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-528' id='line-528'>528</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-529' id='line-529'>529</a>   A3: ((<span class="keyword">not</span> p is_a_prefix_of q &amp; D.q = D1.q) <span class="keyword">or</span>
<a class='lineno' href='#line-530' id='line-530'>530</a>       (<span class="keyword">ex</span> r <span class="keyword">st</span> r <span class="keyword">in</span> dom D2 &amp; q = p^r &amp; D.q = D2.r)) <span class="keyword">by</span> A2, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-531' id='line-531'>531</a>     <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-532' id='line-532'>532</a>     <span class="keyword">suppose</span>
<a class='lineno' href='#line-533' id='line-533'>533</a>     A6: (<span class="keyword">not</span> p is_a_prefix_of q &amp; D.q = D1.q);
<a class='lineno' href='#line-534' id='line-534'>534</a>       [q,x] <span class="keyword">in</span> D <span class="keyword">by</span> A1;
<a class='lineno' href='#line-535' id='line-535'>535</a>       <span class="keyword">then</span> D.q = x <span class="keyword">by</span> A2, <span class="reference">FUNCT_1:def 2</span>;
<a class='lineno' href='#line-536' id='line-536'>536</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-537' id='line-537'>537</a>     A7: D1.q = x <span class="keyword">by</span> A6;
<a class='lineno' href='#line-538' id='line-538'>538</a>     A12: q <span class="keyword">in</span> dom D1
<a class='lineno' href='#line-539' id='line-539'>539</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-540' id='line-540'>540</a>       A14: (q <span class="keyword">in</span> dom D1 &amp; <span class="keyword">not</span> p is_a_proper_prefix_of q <span class="keyword">or</span>
<a class='lineno' href='#line-541' id='line-541'>541</a>           <span class="keyword">ex</span> r <span class="keyword">st</span> r <span class="keyword">in</span> dom D2 &amp; q = p^r) <span class="keyword">by</span> A2, A13, <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-542' id='line-542'>542</a>         <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-543' id='line-543'>543</a>         <span class="keyword">suppose</span> q <span class="keyword">in</span> dom D1 &amp; <span class="keyword">not</span> p is_a_proper_prefix_of q;
<a class='lineno' href='#line-544' id='line-544'>544</a>           <span class="keyword">hence</span> q <span class="keyword">in</span> dom D1;
<a class='lineno' href='#line-545' id='line-545'>545</a>         <span class="keyword">end</span>;
<a class='lineno' href='#line-546' id='line-546'>546</a>         <span class="keyword">suppose</span> <span class="keyword">not</span> (q <span class="keyword">in</span> dom D1 &amp; <span class="keyword">not</span> p is_a_proper_prefix_of q);
<a class='lineno' href='#line-547' id='line-547'>547</a>           <span class="keyword">then</span> <span class="keyword">ex</span> r <span class="keyword">st</span> r <span class="keyword">in</span> dom D2 &amp; q = p^r <span class="keyword">by</span> A14;
<a class='lineno' href='#line-548' id='line-548'>548</a>           <span class="keyword">then</span>
<a class='lineno' href='#line-549' id='line-549'>549</a>         A15: p is_a_prefix_of q <span class="keyword">by</span> <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-550' id='line-550'>550</a>           <span class="keyword">assume</span> <span class="keyword">not</span> q <span class="keyword">in</span> dom D1;
<a class='lineno' href='#line-551' id='line-551'>551</a>           <span class="keyword">thus</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A6, A15;
<a class='lineno' href='#line-552' id='line-552'>552</a>         <span class="keyword">end</span>;
<a class='lineno' href='#line-553' id='line-553'>553</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-554' id='line-554'>554</a>       [q,x] <span class="keyword">in</span> D1 <span class="keyword">by</span> A7, A12, <span class="reference">FUNCT_1:def 2</span>;
<a class='lineno' href='#line-555' id='line-555'>555</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-556' id='line-556'>556</a>     A8: x <span class="keyword">in</span> rng D1 <span class="keyword">by</span> <span class="reference">RELAT_1:def 5</span>;
<a class='lineno' href='#line-557' id='line-557'>557</a>       rng D1 c= X <span class="keyword">by</span> A4, <span class="reference">RELAT_1:def 19</span>;
<a class='lineno' href='#line-558' id='line-558'>558</a>       <span class="keyword">then</span> x <span class="keyword">in</span> X <span class="keyword">by</span> A8;
<a class='lineno' href='#line-559' id='line-559'>559</a>       <span class="keyword">hence</span> x <span class="keyword">in</span> (X \/ Y) <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 3</span>;
<a class='lineno' href='#line-560' id='line-560'>560</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-561' id='line-561'>561</a>     <span class="keyword">suppose</span> <span class="keyword">not</span> (<span class="keyword">not</span> p is_a_prefix_of q &amp; D.q = D1.q);
<a class='lineno' href='#line-562' id='line-562'>562</a>       <span class="keyword">then</span> (<span class="keyword">ex</span> r <span class="keyword">st</span> r <span class="keyword">in</span> dom D2 &amp; q = p^r &amp; D.q = D2.r) <span class="keyword">by</span> A3;
<a class='lineno' href='#line-563' id='line-563'>563</a>       <span class="keyword">then</span> <span class="keyword">consider</span> r <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-564' id='line-564'>564</a>     A9: r <span class="keyword">in</span> dom D2 &amp; q = p^r &amp; D.q = D2.r;
<a class='lineno' href='#line-565' id='line-565'>565</a>       [q,x] <span class="keyword">in</span> D <span class="keyword">by</span> A1;
<a class='lineno' href='#line-566' id='line-566'>566</a>       <span class="keyword">then</span> D.q = x <span class="keyword">by</span> A2, <span class="reference">FUNCT_1:def 2</span>;
<a class='lineno' href='#line-567' id='line-567'>567</a>       <span class="keyword">then</span> D2.r = x <span class="keyword">by</span> A9;
<a class='lineno' href='#line-568' id='line-568'>568</a>       <span class="keyword">then</span> [r,x] <span class="keyword">in</span> D2 <span class="keyword">by</span> A9, <span class="reference">FUNCT_1:def 2</span>;
<a class='lineno' href='#line-569' id='line-569'>569</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-570' id='line-570'>570</a>     A11: x <span class="keyword">in</span> rng D2 <span class="keyword">by</span> <span class="reference">RELAT_1:def 5</span>;
<a class='lineno' href='#line-571' id='line-571'>571</a>       rng D2 c= Y <span class="keyword">by</span> A5, <span class="reference">RELAT_1:def 19</span>;
<a class='lineno' href='#line-572' id='line-572'>572</a>       <span class="keyword">then</span> x <span class="keyword">in</span> Y <span class="keyword">by</span> A11;
<a class='lineno' href='#line-573' id='line-573'>573</a>       <span class="keyword">hence</span> x <span class="keyword">in</span> (X \/ Y) <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 3</span>;
<a class='lineno' href='#line-574' id='line-574'>574</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-575' id='line-575'>575</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-576' id='line-576'>576</a>   <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> <span class="reference">RELAT_1:def 19</span>;
<a class='lineno' href='#line-577' id='line-577'>577</a> <span class="keyword">end</span></span>;
<a class='lineno' href='#line-578' id='line-578'>578</a> 
<a class='lineno' href='#line-579' id='line-579'>579</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-580' id='line-580'>580</a>   <span class="keyword">let</span> P,Q <span class="keyword">be</span> LambdaTerm,
<a class='lineno' href='#line-581' id='line-581'>581</a>       p <span class="keyword">be</span> Element <span class="keyword">of</span> dom P;
<a class='lineno' href='#line-582' id='line-582'>582</a> 
<a class='lineno' href='#line-583' id='line-583'>583</a>   <span class="keyword">cluster</span> P with-replacement (p,Q) -&gt; NAT-valued;
<a class='lineno' href='#line-584' id='line-584'>584</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-585' id='line-585'>585</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-586' id='line-586'>586</a>   A1: P <span class="keyword">is</span> NAT-valued <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-587' id='line-587'>587</a>   A2: Q <span class="keyword">is</span> NAT-valued <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-588' id='line-588'>588</a>     P with-replacement (p,Q) <span class="keyword">is</span> (NAT \/ NAT)-valued <span class="keyword">by</span> A1, A2, Th1;
<a class='lineno' href='#line-589' id='line-589'>589</a>     <span class="keyword">hence</span> P with-replacement (p,Q) <span class="keyword">is</span> NAT-valued <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 3</span>;
<a class='lineno' href='#line-590' id='line-590'>590</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-591' id='line-591'>591</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-592' id='line-592'>592</a> 
<a class='lineno' href='#line-593' id='line-593'>593</a> <span class="keyword">reserve</span> p <span class="keyword">for</span> Element <span class="keyword">of</span> dom P;
<a class='lineno' href='#line-594' id='line-594'>594</a> 
<a class='lineno' href='#line-595' id='line-595'>595</a> <span class="keyword">theorem</span> Th2:
<a class='lineno' href='#line-596' id='line-596'>596</a>   P with-replacement (p,Q) <span class="keyword">is</span> LambdaTerm-like
<a class='lineno' href='#line-597' id='line-597'>597</a> <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-598' id='line-598'>598</a> <span class="set-keyword">  <span class="keyword">set</span></span> R = P with-replacement (p,Q);
<a class='lineno' href='#line-599' id='line-599'>599</a>   <span class="keyword">thus</span> dom R <span class="keyword">is</span> finite
<a class='lineno' href='#line-600' id='line-600'>600</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-601' id='line-601'>601</a>   A1: dom P <span class="keyword">is</span> finite <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-602' id='line-602'>602</a>   A2: dom Q <span class="keyword">is</span> finite <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-603' id='line-603'>603</a>     dom R = (dom P) with-replacement (p,dom Q) <span class="keyword">by</span> <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-604' id='line-604'>604</a>     <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> A1, A2;
<a class='lineno' href='#line-605' id='line-605'>605</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-606' id='line-606'>606</a> 
<a class='lineno' href='#line-607' id='line-607'>607</a>   <span class="keyword">let</span> r;
<a class='lineno' href='#line-608' id='line-608'>608</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-609' id='line-609'>609</a> A3: r <span class="keyword">in</span> dom R;
<a class='lineno' href='#line-610' id='line-610'>610</a>   <span class="keyword">thus</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1}
<a class='lineno' href='#line-611' id='line-611'>611</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-612' id='line-612'>612</a>     dom R = (dom P) with-replacement (p,dom Q) <span class="keyword">by</span> <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-613' id='line-613'>613</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-614' id='line-614'>614</a>   A4: ((r <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r) <span class="keyword">or</span>
<a class='lineno' href='#line-615' id='line-615'>615</a>       (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r = p^q)) <span class="keyword">by</span> A3, <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-616' id='line-616'>616</a>     <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-617' id='line-617'>617</a>     <span class="keyword">suppose</span> (r <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r);
<a class='lineno' href='#line-618' id='line-618'>618</a>       <span class="keyword">hence</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-619' id='line-619'>619</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-620' id='line-620'>620</a>     <span class="keyword">suppose</span> <span class="keyword">not</span> (r <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r);
<a class='lineno' href='#line-621' id='line-621'>621</a>       <span class="keyword">then</span> (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r = p^q) <span class="keyword">by</span> A4;
<a class='lineno' href='#line-622' id='line-622'>622</a>       <span class="keyword">then</span> <span class="keyword">consider</span> q <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-623' id='line-623'>623</a>     A5: q <span class="keyword">in</span> dom Q &amp; r = p^q;
<a class='lineno' href='#line-624' id='line-624'>624</a>       q <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> A5, <span class="reference">Def1</span>;
<a class='lineno' href='#line-625' id='line-625'>625</a>       <span class="keyword">then</span> <span class="keyword">reconsider</span> q <span class="keyword">as</span> FinSequence <span class="keyword">of</span> {0,1};
<a class='lineno' href='#line-626' id='line-626'>626</a>       p <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-627' id='line-627'>627</a>       <span class="keyword">then</span> <span class="keyword">reconsider</span> p <span class="keyword">as</span> FinSequence <span class="keyword">of</span> {0,1};
<a class='lineno' href='#line-628' id='line-628'>628</a>       p^q <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1};
<a class='lineno' href='#line-629' id='line-629'>629</a>       <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> A5;
<a class='lineno' href='#line-630' id='line-630'>630</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-631' id='line-631'>631</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-632' id='line-632'>632</a> <span class="set-keyword">  <span class="keyword">set</span></span> r0 = r^&lt;*0*&gt;;
<a class='lineno' href='#line-633' id='line-633'>633</a> <span class="set-keyword">  <span class="keyword">set</span></span> r1 = r^&lt;*1*&gt;;
<a class='lineno' href='#line-634' id='line-634'>634</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-635' id='line-635'>635</a> A6: r0 <span class="keyword">in</span> dom R;
<a class='lineno' href='#line-636' id='line-636'>636</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-637' id='line-637'>637</a> A7: r1 <span class="keyword">in</span> dom R;
<a class='lineno' href='#line-638' id='line-638'>638</a>   
<a class='lineno' href='#line-639' id='line-639'>639</a>   r <span class="keyword">in</span> (dom P) with-replacement (p,dom Q) <span class="keyword">by</span> A3, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-640' id='line-640'>640</a>   <span class="keyword">then</span>
<a class='lineno' href='#line-641' id='line-641'>641</a> A8: (<span class="keyword">not</span> p is_a_prefix_of r &amp; R.r = P.r) <span class="keyword">or</span>
<a class='lineno' href='#line-642' id='line-642'>642</a>     (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r = p^q &amp; R.r = Q.q)
<a class='lineno' href='#line-643' id='line-643'>643</a>       <span class="keyword">by</span> A3, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-644' id='line-644'>644</a>   <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-645' id='line-645'>645</a>   <span class="keyword">suppose</span>
<a class='lineno' href='#line-646' id='line-646'>646</a>   A22: (<span class="keyword">not</span> p is_a_prefix_of r &amp; R.r = P.r);
<a class='lineno' href='#line-647' id='line-647'>647</a> 
<a class='lineno' href='#line-648' id='line-648'>648</a>   A23: r <span class="keyword">in</span> dom P
<a class='lineno' href='#line-649' id='line-649'>649</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-650' id='line-650'>650</a>       <span class="keyword">assume</span>
<a class='lineno' href='#line-651' id='line-651'>651</a>     A24: <span class="keyword">not</span> r <span class="keyword">in</span> dom P;
<a class='lineno' href='#line-652' id='line-652'>652</a>       r <span class="keyword">in</span> (dom P) with-replacement (p,dom Q) <span class="keyword">by</span> A3, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-653' id='line-653'>653</a>       <span class="keyword">then</span> (r <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r) <span class="keyword">or</span>
<a class='lineno' href='#line-654' id='line-654'>654</a>            (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r = p^q)
<a class='lineno' href='#line-655' id='line-655'>655</a>              <span class="keyword">by</span> <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-656' id='line-656'>656</a>       <span class="keyword">then</span> (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r = p^q) <span class="keyword">by</span> A24;
<a class='lineno' href='#line-657' id='line-657'>657</a>       <span class="keyword">then</span> <span class="keyword">consider</span> q <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-658' id='line-658'>658</a>     A25: q <span class="keyword">in</span> dom Q &amp; r = p^q;
<a class='lineno' href='#line-659' id='line-659'>659</a>       p is_a_prefix_of r <span class="keyword">by</span> A25, <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-660' id='line-660'>660</a>       <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A22;
<a class='lineno' href='#line-661' id='line-661'>661</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-662' id='line-662'>662</a> 
<a class='lineno' href='#line-663' id='line-663'>663</a>   A20: r0 <span class="keyword">in</span> dom P
<a class='lineno' href='#line-664' id='line-664'>664</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-665' id='line-665'>665</a>       <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-666' id='line-666'>666</a>       <span class="keyword">suppose</span>
<a class='lineno' href='#line-667' id='line-667'>667</a>       A31: r0 = p;
<a class='lineno' href='#line-668' id='line-668'>668</a>         p <span class="keyword">in</span> dom P;
<a class='lineno' href='#line-669' id='line-669'>669</a>         <span class="keyword">hence</span> r0 <span class="keyword">in</span> dom P <span class="keyword">by</span> A31;
<a class='lineno' href='#line-670' id='line-670'>670</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-671' id='line-671'>671</a>       <span class="keyword">suppose</span>
<a class='lineno' href='#line-672' id='line-672'>672</a>       A30: r0 &lt;&gt; p;
<a class='lineno' href='#line-673' id='line-673'>673</a>         <span class="keyword">assume</span>
<a class='lineno' href='#line-674' id='line-674'>674</a>       A26: <span class="keyword">not</span> r0 <span class="keyword">in</span> dom P;
<a class='lineno' href='#line-675' id='line-675'>675</a>       A29: <span class="keyword">not</span> p is_a_prefix_of r0
<a class='lineno' href='#line-676' id='line-676'>676</a>         <span class="keyword">proof</span>
<a class='lineno' href='#line-677' id='line-677'>677</a>           <span class="keyword">assume</span> p is_a_prefix_of r0;
<a class='lineno' href='#line-678' id='line-678'>678</a>           <span class="keyword">then</span> p is_a_proper_prefix_of r0 <span class="keyword">by</span> A30, <span class="reference">XBOOLE_0:def 8</span>;
<a class='lineno' href='#line-679' id='line-679'>679</a>           <span class="keyword">then</span> p is_a_prefix_of r <span class="keyword">by</span> <span class="reference">TREES_1:9</span>;
<a class='lineno' href='#line-680' id='line-680'>680</a>           <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A22;
<a class='lineno' href='#line-681' id='line-681'>681</a>         <span class="keyword">end</span>;
<a class='lineno' href='#line-682' id='line-682'>682</a>         r0 <span class="keyword">in</span> (dom P) with-replacement (p,dom Q) <span class="keyword">by</span> A6, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-683' id='line-683'>683</a>         <span class="keyword">then</span> (r0 <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r0) <span class="keyword">or</span>
<a class='lineno' href='#line-684' id='line-684'>684</a>              (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r0 = p^q)
<a class='lineno' href='#line-685' id='line-685'>685</a>                <span class="keyword">by</span> <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-686' id='line-686'>686</a>         <span class="keyword">then</span> (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r0 = p^q) <span class="keyword">by</span> A26;
<a class='lineno' href='#line-687' id='line-687'>687</a>         <span class="keyword">then</span> <span class="keyword">consider</span> q <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-688' id='line-688'>688</a>       A27: q <span class="keyword">in</span> dom Q &amp; r0 = p^q;
<a class='lineno' href='#line-689' id='line-689'>689</a>       A28: p is_a_prefix_of r0 <span class="keyword">by</span> A27, <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-690' id='line-690'>690</a>         <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A28, A29;
<a class='lineno' href='#line-691' id='line-691'>691</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-692' id='line-692'>692</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-693' id='line-693'>693</a> 
<a class='lineno' href='#line-694' id='line-694'>694</a>   A21: r1 <span class="keyword">in</span> dom P <span class="comment">:: (exactly the same as for r0)</span>
<a class='lineno' href='#line-695' id='line-695'>695</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-696' id='line-696'>696</a>       <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-697' id='line-697'>697</a>       <span class="keyword">suppose</span>
<a class='lineno' href='#line-698' id='line-698'>698</a>       A32: r1 = p;
<a class='lineno' href='#line-699' id='line-699'>699</a>         p <span class="keyword">in</span> dom P;
<a class='lineno' href='#line-700' id='line-700'>700</a>         <span class="keyword">hence</span> r1 <span class="keyword">in</span> dom P <span class="keyword">by</span> A32;
<a class='lineno' href='#line-701' id='line-701'>701</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-702' id='line-702'>702</a>       <span class="keyword">suppose</span>
<a class='lineno' href='#line-703' id='line-703'>703</a>       A33: r1 &lt;&gt; p;
<a class='lineno' href='#line-704' id='line-704'>704</a>         <span class="keyword">assume</span>
<a class='lineno' href='#line-705' id='line-705'>705</a>       A34: <span class="keyword">not</span> r1 <span class="keyword">in</span> dom P;
<a class='lineno' href='#line-706' id='line-706'>706</a>       A35: <span class="keyword">not</span> p is_a_prefix_of r1
<a class='lineno' href='#line-707' id='line-707'>707</a>         <span class="keyword">proof</span>
<a class='lineno' href='#line-708' id='line-708'>708</a>           <span class="keyword">assume</span> p is_a_prefix_of r1;
<a class='lineno' href='#line-709' id='line-709'>709</a>           <span class="keyword">then</span> p is_a_proper_prefix_of r1 <span class="keyword">by</span> A33, <span class="reference">XBOOLE_0:def 8</span>;
<a class='lineno' href='#line-710' id='line-710'>710</a>           <span class="keyword">then</span> p is_a_prefix_of r <span class="keyword">by</span> <span class="reference">TREES_1:9</span>;
<a class='lineno' href='#line-711' id='line-711'>711</a>           <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A22;
<a class='lineno' href='#line-712' id='line-712'>712</a>         <span class="keyword">end</span>;
<a class='lineno' href='#line-713' id='line-713'>713</a>         r1 <span class="keyword">in</span> (dom P) with-replacement (p,dom Q) <span class="keyword">by</span> A7, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-714' id='line-714'>714</a>         <span class="keyword">then</span> (r1 <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r1) <span class="keyword">or</span>
<a class='lineno' href='#line-715' id='line-715'>715</a>              (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r1 = p^q)
<a class='lineno' href='#line-716' id='line-716'>716</a>                <span class="keyword">by</span> <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-717' id='line-717'>717</a>         <span class="keyword">then</span> (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r1 = p^q) <span class="keyword">by</span> A34;
<a class='lineno' href='#line-718' id='line-718'>718</a>         <span class="keyword">then</span> <span class="keyword">consider</span> q <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-719' id='line-719'>719</a>       A36: q <span class="keyword">in</span> dom Q &amp; r1 = p^q;
<a class='lineno' href='#line-720' id='line-720'>720</a>       A37: p is_a_prefix_of r1 <span class="keyword">by</span> A36, <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-721' id='line-721'>721</a>         <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A37, A35;
<a class='lineno' href='#line-722' id='line-722'>722</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-723' id='line-723'>723</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-724' id='line-724'>724</a> 
<a class='lineno' href='#line-725' id='line-725'>725</a>     P.r = 0 <span class="keyword">by</span> <span class="reference">Def1</span>, A20, A21, A23;
<a class='lineno' href='#line-726' id='line-726'>726</a>     <span class="keyword">hence</span> R.r = 0 <span class="keyword">by</span> A22;
<a class='lineno' href='#line-727' id='line-727'>727</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-728' id='line-728'>728</a>   <span class="keyword">suppose</span> <span class="keyword">not</span> (<span class="keyword">not</span> p is_a_prefix_of r &amp; R.r = P.r);
<a class='lineno' href='#line-729' id='line-729'>729</a>     <span class="keyword">then</span> (<span class="keyword">ex</span> q <span class="keyword">st</span> q <span class="keyword">in</span> dom Q &amp; r = p^q &amp; R.r = Q.q) <span class="keyword">by</span> A8;
<a class='lineno' href='#line-730' id='line-730'>730</a>     <span class="keyword">then</span> <span class="keyword">consider</span> q <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-731' id='line-731'>731</a>   A9: q <span class="keyword">in</span> dom Q <span class="keyword">and</span>
<a class='lineno' href='#line-732' id='line-732'>732</a>   A10: r = p^q &amp; R.r = Q.q;
<a class='lineno' href='#line-733' id='line-733'>733</a> 
<a class='lineno' href='#line-734' id='line-734'>734</a>   A11: q^&lt;*0*&gt; <span class="keyword">in</span> dom Q
<a class='lineno' href='#line-735' id='line-735'>735</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-736' id='line-736'>736</a>       r0 <span class="keyword">in</span> (dom P) with-replacement (p,dom Q) <span class="keyword">by</span> A6, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-737' id='line-737'>737</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-738' id='line-738'>738</a>     A12: (r0 <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r0) <span class="keyword">or</span>
<a class='lineno' href='#line-739' id='line-739'>739</a>          (<span class="keyword">ex</span> q0 <span class="keyword">st</span> q0 <span class="keyword">in</span> dom Q &amp; r0 = p^q0)
<a class='lineno' href='#line-740' id='line-740'>740</a>            <span class="keyword">by</span> <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-741' id='line-741'>741</a>       (<span class="keyword">ex</span> q0 <span class="keyword">st</span> q0 <span class="keyword">in</span> dom Q &amp; r0 = p^q0)
<a class='lineno' href='#line-742' id='line-742'>742</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-743' id='line-743'>743</a>         <span class="keyword">assume</span> <span class="keyword">not</span> (<span class="keyword">ex</span> q0 <span class="keyword">st</span> q0 <span class="keyword">in</span> dom Q &amp; r0 = p^q0);
<a class='lineno' href='#line-744' id='line-744'>744</a>         <span class="keyword">then</span>
<a class='lineno' href='#line-745' id='line-745'>745</a>       A15: (r0 <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r0) <span class="keyword">by</span> A12;
<a class='lineno' href='#line-746' id='line-746'>746</a>         p is_a_prefix_of r <span class="keyword">by</span> A10, <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-747' id='line-747'>747</a>         <span class="keyword">then</span> p is_a_proper_prefix_of r0 <span class="keyword">by</span> <span class="reference">TREES_1:8</span>;
<a class='lineno' href='#line-748' id='line-748'>748</a>         <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A15;
<a class='lineno' href='#line-749' id='line-749'>749</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-750' id='line-750'>750</a>       <span class="keyword">then</span> <span class="keyword">consider</span> q0 <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-751' id='line-751'>751</a>     A13: q0 <span class="keyword">in</span> dom Q <span class="keyword">and</span>
<a class='lineno' href='#line-752' id='line-752'>752</a>     A14: r0 = p^q0;
<a class='lineno' href='#line-753' id='line-753'>753</a>       p^q0 = r0 <span class="keyword">by</span> A14
<a class='lineno' href='#line-754' id='line-754'>754</a>           .= r^&lt;*0*&gt;
<a class='lineno' href='#line-755' id='line-755'>755</a>           .= (p^q)^&lt;*0*&gt; <span class="keyword">by</span> A10
<a class='lineno' href='#line-756' id='line-756'>756</a>           .= p^(q^&lt;*0*&gt;) <span class="keyword">by</span> <span class="reference">FINSEQ_1:32</span>;
<a class='lineno' href='#line-757' id='line-757'>757</a>       <span class="keyword">then</span> q0 = q^&lt;*0*&gt; <span class="keyword">by</span> <span class="reference">FINSEQ_1:33</span>;
<a class='lineno' href='#line-758' id='line-758'>758</a>       <span class="keyword">hence</span> q^&lt;*0*&gt; <span class="keyword">in</span> dom Q <span class="keyword">by</span> A13;
<a class='lineno' href='#line-759' id='line-759'>759</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-760' id='line-760'>760</a> 
<a class='lineno' href='#line-761' id='line-761'>761</a>   A16: q^&lt;*1*&gt; <span class="keyword">in</span> dom Q <span class="comment">:: (exactly the same as for q^&lt;*0*&gt;)</span>
<a class='lineno' href='#line-762' id='line-762'>762</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-763' id='line-763'>763</a>       r1 <span class="keyword">in</span> (dom P) with-replacement (p,dom Q) <span class="keyword">by</span> A7, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-764' id='line-764'>764</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-765' id='line-765'>765</a>     A17: (r1 <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r1) <span class="keyword">or</span>
<a class='lineno' href='#line-766' id='line-766'>766</a>          (<span class="keyword">ex</span> q1 <span class="keyword">st</span> q1 <span class="keyword">in</span> dom Q &amp; r1 = p^q1)
<a class='lineno' href='#line-767' id='line-767'>767</a>            <span class="keyword">by</span> <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-768' id='line-768'>768</a>       (<span class="keyword">ex</span> q1 <span class="keyword">st</span> q1 <span class="keyword">in</span> dom Q &amp; r1 = p^q1)
<a class='lineno' href='#line-769' id='line-769'>769</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-770' id='line-770'>770</a>         <span class="keyword">assume</span> <span class="keyword">not</span> (<span class="keyword">ex</span> q1 <span class="keyword">st</span> q1 <span class="keyword">in</span> dom Q &amp; r1 = p^q1);
<a class='lineno' href='#line-771' id='line-771'>771</a>         <span class="keyword">then</span>
<a class='lineno' href='#line-772' id='line-772'>772</a>       A15: (r1 <span class="keyword">in</span> dom P &amp; <span class="keyword">not</span> p is_a_proper_prefix_of r1) <span class="keyword">by</span> A17;
<a class='lineno' href='#line-773' id='line-773'>773</a>         p is_a_prefix_of r <span class="keyword">by</span> A10, <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-774' id='line-774'>774</a>         <span class="keyword">then</span> p is_a_proper_prefix_of r1 <span class="keyword">by</span> <span class="reference">TREES_1:8</span>;
<a class='lineno' href='#line-775' id='line-775'>775</a>         <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A15;
<a class='lineno' href='#line-776' id='line-776'>776</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-777' id='line-777'>777</a>       <span class="keyword">then</span> <span class="keyword">consider</span> q1 <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-778' id='line-778'>778</a>     A18: q1 <span class="keyword">in</span> dom Q <span class="keyword">and</span>
<a class='lineno' href='#line-779' id='line-779'>779</a>     A19: r1 = p^q1;
<a class='lineno' href='#line-780' id='line-780'>780</a>       p^q1 = r1 <span class="keyword">by</span> A19
<a class='lineno' href='#line-781' id='line-781'>781</a>           .= r^&lt;*1*&gt;
<a class='lineno' href='#line-782' id='line-782'>782</a>           .= (p^q)^&lt;*1*&gt; <span class="keyword">by</span> A10
<a class='lineno' href='#line-783' id='line-783'>783</a>           .= p^(q^&lt;*1*&gt;) <span class="keyword">by</span> <span class="reference">FINSEQ_1:32</span>;
<a class='lineno' href='#line-784' id='line-784'>784</a>       <span class="keyword">then</span> q1 = q^&lt;*1*&gt; <span class="keyword">by</span> <span class="reference">FINSEQ_1:33</span>;
<a class='lineno' href='#line-785' id='line-785'>785</a>       <span class="keyword">hence</span> q^&lt;*1*&gt; <span class="keyword">in</span> dom Q <span class="keyword">by</span> A18;
<a class='lineno' href='#line-786' id='line-786'>786</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-787' id='line-787'>787</a> 
<a class='lineno' href='#line-788' id='line-788'>788</a>     Q.q = 0 <span class="keyword">by</span> <span class="reference">Def1</span>, A9, A11, A16;
<a class='lineno' href='#line-789' id='line-789'>789</a>     <span class="keyword">hence</span> R.r = 0 <span class="keyword">by</span> A10;
<a class='lineno' href='#line-790' id='line-790'>790</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-791' id='line-791'>791</a> <span class="keyword">end</span></span>;
<a class='lineno' href='#line-792' id='line-792'>792</a> 
<a class='lineno' href='#line-793' id='line-793'>793</a> <span class="keyword">registration</span>
<a class='lineno' href='#line-794' id='line-794'>794</a>   <span class="keyword">let</span> P,Q <span class="keyword">be</span> LambdaTerm,
<a class='lineno' href='#line-795' id='line-795'>795</a>       p <span class="keyword">be</span> Element <span class="keyword">of</span> dom P;
<a class='lineno' href='#line-796' id='line-796'>796</a> 
<a class='lineno' href='#line-797' id='line-797'>797</a>   <span class="keyword">cluster</span> P with-replacement (p,Q) -&gt; LambdaTerm-like;
<a class='lineno' href='#line-798' id='line-798'>798</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-799' id='line-799'>799</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-800' id='line-800'>800</a>     <span class="keyword">thus</span> <span class="keyword">thesis</span> <span class="keyword">by</span> Th2;
<a class='lineno' href='#line-801' id='line-801'>801</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-802' id='line-802'>802</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-803' id='line-803'>803</a> 
<a class='lineno' href='#line-804' id='line-804'>804</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-805' id='line-805'>805</a>   <span class="keyword">let</span> P <span class="keyword">be</span> LambdaTerm,
<a class='lineno' href='#line-806' id='line-806'>806</a>       p <span class="keyword">be</span> Element <span class="keyword">of</span> dom P,
<a class='lineno' href='#line-807' id='line-807'>807</a>       Q <span class="keyword">be</span> LambdaTerm;
<a class='lineno' href='#line-808' id='line-808'>808</a> 
<a class='lineno' href='#line-809' id='line-809'>809</a>   <span class="keyword">redefine</span> <span class="keyword">func</span> P with-replacement (p,Q) -&gt; LambdaTerm;
<a class='lineno' href='#line-810' id='line-810'>810</a>   <span class="keyword">coherence</span>;
<a class='lineno' href='#line-811' id='line-811'>811</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-11">
              
                <h3 id="hd-1.2">
                  
                  <a href="#hd-1.2" class="headnumber">
                    1.2
                  </a>
                  
                  Helper definitions
                </h3>
              

              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-12">
              
                <p>Some helper definitions for working with lambda terms.</p>

              

              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-13">
              
                <h4 id="hd-1.2.1">
                  
                  <a href="#hd-1.2.1" class="headnumber">
                    1.2.1
                  </a>
                  
                  Variable occurences
                </h4>
              

              
                <ul class="vocabulary">
                
                
                <li class="type-pred"><a href="#line-821"><code>is_variable_in</code></a></li>
                
                
                <li class="type-pred"><a href="#line-826"><code>is_abstraction_in</code></a></li>
                
                
                <li class="type-pred"><a href="#line-831"><code>is_application_in</code></a></li>
                
                
                <li class="type-pred"><a href="#line-840"><code>M,r</code></a></li>
                
                
                <li class="type-pred"><a href="#line-845"><code>M,r</code></a></li>
                
                
                <li class="type-pred"><a href="#line-854"><code>contains_variable</code></a></li>
                
                </ul>
              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-14">
              
                
              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-817' id='line-817'>817</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-818' id='line-818'>818</a>   <span class="keyword">let</span> M <span class="keyword">be</span> LambdaTerm,
<a class='lineno' href='#line-819' id='line-819'>819</a>       r; <span class="comment">:: be Node of M;</span>
<a class='lineno' href='#line-820' id='line-820'>820</a>   
<a class='lineno' href='#line-821' id='line-821'>821</a>   <span class="keyword">pred</span> r is_variable_in M <span class="keyword">means</span>
<a class='lineno' href='#line-822' id='line-822'>822</a>     :<span class="reference">Def5</span>:
<a class='lineno' href='#line-823' id='line-823'>823</a>     r <span class="keyword">in</span> dom M &amp;
<a class='lineno' href='#line-824' id='line-824'>824</a>     <span class="keyword">not</span> r^&lt;*0*&gt; <span class="keyword">in</span> dom M;
<a class='lineno' href='#line-825' id='line-825'>825</a> 
<a class='lineno' href='#line-826' id='line-826'>826</a>   <span class="keyword">pred</span> r is_abstraction_in M <span class="keyword">means</span>
<a class='lineno' href='#line-827' id='line-827'>827</a>     :<span class="reference">Def6</span>:
<a class='lineno' href='#line-828' id='line-828'>828</a>     r <span class="keyword">in</span> dom M &amp;
<a class='lineno' href='#line-829' id='line-829'>829</a>     r^&lt;*0*&gt; <span class="keyword">in</span> dom M &amp; <span class="keyword">not</span> r^&lt;*1*&gt; <span class="keyword">in</span> dom M;
<a class='lineno' href='#line-830' id='line-830'>830</a> 
<a class='lineno' href='#line-831' id='line-831'>831</a>   <span class="keyword">pred</span> r is_application_in M <span class="keyword">means</span>
<a class='lineno' href='#line-832' id='line-832'>832</a>     :<span class="reference">Def7</span>:
<a class='lineno' href='#line-833' id='line-833'>833</a>     r <span class="keyword">in</span> dom M &amp;
<a class='lineno' href='#line-834' id='line-834'>834</a>     r^&lt;*0*&gt; <span class="keyword">in</span> dom M &amp; r^&lt;*1*&gt; <span class="keyword">in</span> dom M;
<a class='lineno' href='#line-835' id='line-835'>835</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-836' id='line-836'>836</a> 
<a class='lineno' href='#line-837' id='line-837'>837</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-838' id='line-838'>838</a>   <span class="keyword">let</span> M,r,v;
<a class='lineno' href='#line-839' id='line-839'>839</a> 
<a class='lineno' href='#line-840' id='line-840'>840</a>   <span class="keyword">pred</span> M,r holds_variable v <span class="keyword">means</span>
<a class='lineno' href='#line-841' id='line-841'>841</a>     :<span class="reference">Def8</span>:
<a class='lineno' href='#line-842' id='line-842'>842</a>     r is_variable_in M &amp;
<a class='lineno' href='#line-843' id='line-843'>843</a>     M.r = n;
<a class='lineno' href='#line-844' id='line-844'>844</a> 
<a class='lineno' href='#line-845' id='line-845'>845</a>   <span class="keyword">pred</span> M,r abstracts v <span class="keyword">means</span>
<a class='lineno' href='#line-846' id='line-846'>846</a>     :<span class="reference">Def9</span>:
<a class='lineno' href='#line-847' id='line-847'>847</a>     r is_abstraction_in M &amp;
<a class='lineno' href='#line-848' id='line-848'>848</a>     M.r = n;
<a class='lineno' href='#line-849' id='line-849'>849</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-850' id='line-850'>850</a> 
<a class='lineno' href='#line-851' id='line-851'>851</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-852' id='line-852'>852</a>   <span class="keyword">let</span> M,v;
<a class='lineno' href='#line-853' id='line-853'>853</a> 
<a class='lineno' href='#line-854' id='line-854'>854</a>   <span class="keyword">pred</span> M contains_variable v <span class="keyword">means</span>
<a class='lineno' href='#line-855' id='line-855'>855</a>     :<span class="reference">Def10</span>:
<a class='lineno' href='#line-856' id='line-856'>856</a>     <span class="keyword">ex</span> r <span class="keyword">st</span> M,r holds_variable v;
<a class='lineno' href='#line-857' id='line-857'>857</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-15">
              
                <h4 id="hd-1.2.2">
                  
                  <a href="#hd-1.2.2" class="headnumber">
                    1.2.2
                  </a>
                  
                  Abstraction and application
                </h4>
              

              
                <ul class="vocabulary">
                
                
                <li class="type-func"><a href="#line-1143"><code>Var</code></a></li>
                
                
                <li class="type-func"><a href="#line-1175"><code>Abs</code></a></li>
                
                
                <li class="type-func"><a href="#line-1261"><code>App</code></a></li>
                
                </ul>
              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-16">
              
                
              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-861' id='line-861'>861</a> <span class="keyword">reserve</span> p <span class="keyword">for</span> FinSequence <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-862' id='line-862'>862</a> 
<a class='lineno' href='#line-863' id='line-863'>863</a> <span class="keyword">theorem</span> Th6:
<a class='lineno' href='#line-864' id='line-864'>864</a>     <span class="keyword">not</span> q,r are_c=-comparable
<a class='lineno' href='#line-865' id='line-865'>865</a>   <span class="keyword">implies</span>
<a class='lineno' href='#line-866' id='line-866'>866</a>     <span class="keyword">not</span> q is_a_prefix_of r
<a class='lineno' href='#line-867' id='line-867'>867</a>   &amp; <span class="keyword">not</span> r is_a_prefix_of q
<a class='lineno' href='#line-868' id='line-868'>868</a>   &amp; <span class="keyword">not</span> q is_a_proper_prefix_of r
<a class='lineno' href='#line-869' id='line-869'>869</a>   &amp; <span class="keyword">not</span> r is_a_proper_prefix_of q
<a class='lineno' href='#line-870' id='line-870'>870</a> <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-871' id='line-871'>871</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-872' id='line-872'>872</a> A1: <span class="keyword">not</span> q,r are_c=-comparable;
<a class='lineno' href='#line-873' id='line-873'>873</a>   
<a class='lineno' href='#line-874' id='line-874'>874</a>   <span class="keyword">thus</span> <span class="keyword">not</span> q is_a_prefix_of r
<a class='lineno' href='#line-875' id='line-875'>875</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-876' id='line-876'>876</a>     <span class="keyword">assume</span> q c= r;
<a class='lineno' href='#line-877' id='line-877'>877</a>     <span class="keyword">then</span> q,r are_c=-comparable <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 9</span>;
<a class='lineno' href='#line-878' id='line-878'>878</a>     <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A1;
<a class='lineno' href='#line-879' id='line-879'>879</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-880' id='line-880'>880</a>   
<a class='lineno' href='#line-881' id='line-881'>881</a>   <span class="keyword">thus</span> <span class="keyword">not</span> r is_a_prefix_of q
<a class='lineno' href='#line-882' id='line-882'>882</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-883' id='line-883'>883</a>     <span class="keyword">assume</span> r c= q;
<a class='lineno' href='#line-884' id='line-884'>884</a>     <span class="keyword">then</span> r,q are_c=-comparable <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 9</span>;
<a class='lineno' href='#line-885' id='line-885'>885</a>     <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A1;
<a class='lineno' href='#line-886' id='line-886'>886</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-887' id='line-887'>887</a> 
<a class='lineno' href='#line-888' id='line-888'>888</a>   <span class="keyword">thus</span> <span class="keyword">not</span> q is_a_proper_prefix_of r
<a class='lineno' href='#line-889' id='line-889'>889</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-890' id='line-890'>890</a>     <span class="keyword">assume</span> q c&lt; r;
<a class='lineno' href='#line-891' id='line-891'>891</a>     <span class="keyword">then</span> q c= r <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 8</span>;
<a class='lineno' href='#line-892' id='line-892'>892</a>     <span class="keyword">then</span> q,r are_c=-comparable <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 9</span>;
<a class='lineno' href='#line-893' id='line-893'>893</a>     <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A1;
<a class='lineno' href='#line-894' id='line-894'>894</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-895' id='line-895'>895</a> 
<a class='lineno' href='#line-896' id='line-896'>896</a>   <span class="keyword">thus</span> <span class="keyword">not</span> r is_a_proper_prefix_of q
<a class='lineno' href='#line-897' id='line-897'>897</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-898' id='line-898'>898</a>     <span class="keyword">assume</span> r c&lt; q;
<a class='lineno' href='#line-899' id='line-899'>899</a>     <span class="keyword">then</span> r c= q <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 8</span>;
<a class='lineno' href='#line-900' id='line-900'>900</a>     <span class="keyword">then</span> r,q are_c=-comparable <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 9</span>;
<a class='lineno' href='#line-901' id='line-901'>901</a>     <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A1;
<a class='lineno' href='#line-902' id='line-902'>902</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-903' id='line-903'>903</a> <span class="keyword">end</span></span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-17">
              
                <p>Why the hell would TARSKI:def 3 not include transitivity?!</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-906' id='line-906'>906</a> <span class="keyword">theorem</span> Th8:
<a class='lineno' href='#line-907' id='line-907'>907</a>   X c= Y &amp; Y c= Z <span class="keyword">implies</span> X c= Z
<a class='lineno' href='#line-908' id='line-908'>908</a> <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-909' id='line-909'>909</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-910' id='line-910'>910</a> A1: X c= Y &amp; Y c= Z;
<a class='lineno' href='#line-911' id='line-911'>911</a>   x <span class="keyword">in</span> X <span class="keyword">implies</span> x <span class="keyword">in</span> Z
<a class='lineno' href='#line-912' id='line-912'>912</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-913' id='line-913'>913</a>     <span class="keyword">assume</span> x <span class="keyword">in</span> X;
<a class='lineno' href='#line-914' id='line-914'>914</a>     <span class="keyword">then</span> x <span class="keyword">in</span> Y <span class="keyword">by</span> A1, <span class="reference">TARSKI:def 3</span>;
<a class='lineno' href='#line-915' id='line-915'>915</a>     <span class="keyword">hence</span> x <span class="keyword">in</span> Z <span class="keyword">by</span> A1, <span class="reference">TARSKI:def 3</span>;
<a class='lineno' href='#line-916' id='line-916'>916</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-917' id='line-917'>917</a>   <span class="keyword">hence</span> X c= Z <span class="keyword">by</span> <span class="reference">TARSKI:def 3</span>;
<a class='lineno' href='#line-918' id='line-918'>918</a> <span class="keyword">end</span></span>;
<a class='lineno' href='#line-919' id='line-919'>919</a> 
<a class='lineno' href='#line-920' id='line-920'>920</a> <span class="keyword">theorem</span> Th7:
<a class='lineno' href='#line-921' id='line-921'>921</a>     <span class="keyword">not</span> p,q are_c=-comparable
<a class='lineno' href='#line-922' id='line-922'>922</a>   <span class="keyword">implies</span>
<a class='lineno' href='#line-923' id='line-923'>923</a>     <span class="keyword">not</span> p,q^r are_c=-comparable
<a class='lineno' href='#line-924' id='line-924'>924</a> <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-925' id='line-925'>925</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-926' id='line-926'>926</a> A1: <span class="keyword">not</span> p,q are_c=-comparable;
<a class='lineno' href='#line-927' id='line-927'>927</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-928' id='line-928'>928</a> A2: p,q^r are_c=-comparable;
<a class='lineno' href='#line-929' id='line-929'>929</a>   <span class="keyword">then</span>
<a class='lineno' href='#line-930' id='line-930'>930</a> A3: p c= q^r <span class="keyword">or</span> q^r c= p <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 9</span>;
<a class='lineno' href='#line-931' id='line-931'>931</a>   <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-932' id='line-932'>932</a>   <span class="keyword">suppose</span>
<a class='lineno' href='#line-933' id='line-933'>933</a> <span class="error">::&gt;     *60</span>
<a class='lineno' href='#line-934' id='line-934'>934</a> A5: p c= q^r;
<a class='lineno' href='#line-935' id='line-935'>935</a>     q c= q^r <span class="keyword">by</span> <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-936' id='line-936'>936</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-937' id='line-937'>937</a>   <span class="keyword">suppose</span> <span class="keyword">not</span> p c= q^r;
<a class='lineno' href='#line-938' id='line-938'>938</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-939' id='line-939'>939</a>   A4: q^r c= p <span class="keyword">by</span> A3;
<a class='lineno' href='#line-940' id='line-940'>940</a>     q c= q^r <span class="keyword">by</span> <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-941' id='line-941'>941</a>     <span class="keyword">then</span> q c= p <span class="keyword">by</span> A4, Th8;
<a class='lineno' href='#line-942' id='line-942'>942</a>     <span class="keyword">then</span> q,p are_c=-comparable <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 9</span>;
<a class='lineno' href='#line-943' id='line-943'>943</a>     <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A1;
<a class='lineno' href='#line-944' id='line-944'>944</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-945' id='line-945'>945</a> <span class="keyword">end</span></span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-18">
              
                <p>The <code>DecoratedTree</code> analog of <code>TREES_1:33</code></p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-948' id='line-948'>948</a> <span class="keyword">theorem</span> Th3:
<a class='lineno' href='#line-949' id='line-949'>949</a>     r <span class="keyword">in</span> dom D
<a class='lineno' href='#line-950' id='line-950'>950</a>   <span class="keyword">implies</span>
<a class='lineno' href='#line-951' id='line-951'>951</a>     D2 = D with-replacement (r,D2)|r
<a class='lineno' href='#line-952' id='line-952'>952</a> <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-953' id='line-953'>953</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-954' id='line-954'>954</a> A1: r <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-955' id='line-955'>955</a> 
<a class='lineno' href='#line-956' id='line-956'>956</a> A2: dom D2 = ((dom D) with-replacement (r,dom D2))|r <span class="keyword">by</span> A1, <span class="reference">TREES_1:33</span>
<a class='lineno' href='#line-957' id='line-957'>957</a>           .= (dom (D with-replacement (r,D2)))|r <span class="keyword">by</span> A1, <span class="reference">TREES_2:def 11</span>
<a class='lineno' href='#line-958' id='line-958'>958</a>           .= dom ((D with-replacement (r,D2))|r) <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-959' id='line-959'>959</a> <span class="set-keyword">  
<a class='lineno' href='#line-960' id='line-960'>960</a>   <span class="keyword">set</span></span> E = D with-replacement (r,D2);
<a class='lineno' href='#line-961' id='line-961'>961</a> A3: <span class="keyword">for</span> q <span class="keyword">being</span> Node <span class="keyword">of</span> E|r <span class="keyword">holds</span> (E|r).q = D2.q
<a class='lineno' href='#line-962' id='line-962'>962</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-963' id='line-963'>963</a>     <span class="keyword">let</span> q <span class="keyword">be</span> Node <span class="keyword">of</span> E|r;
<a class='lineno' href='#line-964' id='line-964'>964</a>     q <span class="keyword">in</span> dom (E|r);
<a class='lineno' href='#line-965' id='line-965'>965</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-966' id='line-966'>966</a>   A11: q <span class="keyword">in</span> (dom E)|r <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-967' id='line-967'>967</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-968' id='line-968'>968</a>   A10: (E|r).q = E.(r^q) <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-969' id='line-969'>969</a> <span class="set-keyword">    <span class="keyword">set</span></span> rq = r^q;
<a class='lineno' href='#line-970' id='line-970'>970</a>   A5: r^q <span class="keyword">in</span> (dom D) with-replacement (r,dom D2)
<a class='lineno' href='#line-971' id='line-971'>971</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-972' id='line-972'>972</a>       <span class="keyword">ex</span> r2 <span class="keyword">st</span> r2 <span class="keyword">in</span> dom D2 &amp; r = r^r2
<a class='lineno' href='#line-973' id='line-973'>973</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-974' id='line-974'>974</a>         <span class="keyword">take</span> &lt;*&gt; NAT;
<a class='lineno' href='#line-975' id='line-975'>975</a>         <span class="keyword">thus</span> &lt;*&gt; NAT <span class="keyword">in</span> dom D2 <span class="keyword">by</span> <span class="reference">TREES_1:22</span>;
<a class='lineno' href='#line-976' id='line-976'>976</a>         r = r^{} <span class="keyword">by</span> <span class="reference">FINSEQ_1:34</span>;
<a class='lineno' href='#line-977' id='line-977'>977</a>         <span class="keyword">hence</span> r = r^(&lt;*&gt; NAT) <span class="keyword">by</span> <span class="reference">FINSEQ_1:def 6</span>;
<a class='lineno' href='#line-978' id='line-978'>978</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-979' id='line-979'>979</a>       <span class="keyword">then</span> r <span class="keyword">in</span> (dom D) with-replacement (r,dom D2) <span class="keyword">by</span> A1, <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-980' id='line-980'>980</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-981' id='line-981'>981</a>     A12: r <span class="keyword">in</span> dom E <span class="keyword">by</span> A1, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-982' id='line-982'>982</a>       <span class="keyword">then</span> r^q <span class="keyword">in</span> dom E <span class="keyword">by</span> A1, A11, A12, <span class="reference">TREES_1:def 6</span>;
<a class='lineno' href='#line-983' id='line-983'>983</a>       <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> A1, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-984' id='line-984'>984</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-985' id='line-985'>985</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-986' id='line-986'>986</a>   A6: (<span class="keyword">not</span> r is_a_prefix_of rq &amp; E.rq = D.rq) <span class="keyword">or</span>
<a class='lineno' href='#line-987' id='line-987'>987</a>       (<span class="keyword">ex</span> q2 <span class="keyword">st</span> q2 <span class="keyword">in</span> dom D2 &amp; rq = r^q2 &amp; E.rq = D2.q2)
<a class='lineno' href='#line-988' id='line-988'>988</a>         <span class="keyword">by</span> A1, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-989' id='line-989'>989</a>     <span class="keyword">ex</span> q2 <span class="keyword">st</span> q2 <span class="keyword">in</span> dom D2 &amp; rq = r^q2 &amp; E.rq = D2.q2
<a class='lineno' href='#line-990' id='line-990'>990</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-991' id='line-991'>991</a>       <span class="keyword">assume</span> <span class="keyword">not</span> (<span class="keyword">ex</span> q2 <span class="keyword">st</span> q2 <span class="keyword">in</span> dom D2 &amp; rq = r^q2 &amp; E.rq = D2.q2);
<a class='lineno' href='#line-992' id='line-992'>992</a>       <span class="keyword">then</span> <span class="keyword">not</span> r is_a_prefix_of rq <span class="keyword">by</span> A6;
<a class='lineno' href='#line-993' id='line-993'>993</a>       <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-994' id='line-994'>994</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-995' id='line-995'>995</a>     <span class="keyword">then</span> <span class="keyword">consider</span> q2 <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-996' id='line-996'>996</a>   A7: q2 <span class="keyword">in</span> dom D2 <span class="keyword">and</span>
<a class='lineno' href='#line-997' id='line-997'>997</a>   A8: rq = r^q2 <span class="keyword">and</span>
<a class='lineno' href='#line-998' id='line-998'>998</a>   A9: E.rq = D2.q2;
<a class='lineno' href='#line-999' id='line-999'>999</a>     q2 = q <span class="keyword">by</span> A8, <span class="reference">FINSEQ_1:33</span>;
<a class='lineno' href='#line-1000' id='line-1000'>1000</a>     <span class="keyword">hence</span> (E|r).q = D2.q <span class="keyword">by</span> A9, A10;
<a class='lineno' href='#line-1001' id='line-1001'>1001</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-1002' id='line-1002'>1002</a>   <span class="keyword">thus</span> <span class="keyword">thesis</span> <span class="keyword">by</span> A2, A3, <span class="reference">TREES_4:def 1</span>;
<a class='lineno' href='#line-1003' id='line-1003'>1003</a> <span class="keyword">end</span></span>;
<a class='lineno' href='#line-1004' id='line-1004'>1004</a> 
<a class='lineno' href='#line-1005' id='line-1005'>1005</a> <span class="keyword">reserve</span> q,r <span class="keyword">for</span> Element <span class="keyword">of</span> T;
<a class='lineno' href='#line-1006' id='line-1006'>1006</a> 
<a class='lineno' href='#line-1007' id='line-1007'>1007</a> <span class="keyword">theorem</span> Th4:
<a class='lineno' href='#line-1008' id='line-1008'>1008</a>     <span class="keyword">not</span> q,r are_c=-comparable
<a class='lineno' href='#line-1009' id='line-1009'>1009</a>   <span class="keyword">implies</span>
<a class='lineno' href='#line-1010' id='line-1010'>1010</a>     T|r = (T with-replacement (q,T2))|r
<a class='lineno' href='#line-1011' id='line-1011'>1011</a> <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-1012' id='line-1012'>1012</a> A5: q <span class="keyword">in</span> T;
<a class='lineno' href='#line-1013' id='line-1013'>1013</a> A3: r <span class="keyword">in</span> T;
<a class='lineno' href='#line-1014' id='line-1014'>1014</a> 
<a class='lineno' href='#line-1015' id='line-1015'>1015</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-1016' id='line-1016'>1016</a> A6: <span class="keyword">not</span> q,r are_c=-comparable;
<a class='lineno' href='#line-1017' id='line-1017'>1017</a>   <span class="keyword">then</span>
<a class='lineno' href='#line-1018' id='line-1018'>1018</a> A13: <span class="keyword">not</span> q,r^p are_c=-comparable <span class="keyword">by</span> Th7;
<a class='lineno' href='#line-1019' id='line-1019'>1019</a> 
<a class='lineno' href='#line-1020' id='line-1020'>1020</a> A4: r <span class="keyword">in</span> T with-replacement (q,T2)
<a class='lineno' href='#line-1021' id='line-1021'>1021</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-1022' id='line-1022'>1022</a>     <span class="keyword">not</span> q is_a_proper_prefix_of r <span class="keyword">by</span> A6, Th6;
<a class='lineno' href='#line-1023' id='line-1023'>1023</a>     <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> A3, A5, <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-1024' id='line-1024'>1024</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-1025' id='line-1025'>1025</a> 
<a class='lineno' href='#line-1026' id='line-1026'>1026</a> A1: p <span class="keyword">in</span> T|r <span class="keyword">implies</span> p <span class="keyword">in</span> (T with-replacement (q,T2))|r
<a class='lineno' href='#line-1027' id='line-1027'>1027</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-1028' id='line-1028'>1028</a>     <span class="keyword">assume</span> p <span class="keyword">in</span> T|r;
<a class='lineno' href='#line-1029' id='line-1029'>1029</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-1030' id='line-1030'>1030</a>   A7: r^p <span class="keyword">in</span> T <span class="keyword">by</span> A3, <span class="reference">TREES_1:def 6</span>;
<a class='lineno' href='#line-1031' id='line-1031'>1031</a>     r^p <span class="keyword">in</span> T with-replacement (q,T2)
<a class='lineno' href='#line-1032' id='line-1032'>1032</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-1033' id='line-1033'>1033</a>       <span class="keyword">not</span> q,r^p are_c=-comparable <span class="keyword">by</span> A13;
<a class='lineno' href='#line-1034' id='line-1034'>1034</a>       <span class="keyword">then</span> <span class="keyword">not</span> q is_a_proper_prefix_of r^p <span class="keyword">by</span> A6, Th6;
<a class='lineno' href='#line-1035' id='line-1035'>1035</a>       <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> A7, A5, <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-1036' id='line-1036'>1036</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-1037' id='line-1037'>1037</a>     <span class="keyword">hence</span> p <span class="keyword">in</span> (T with-replacement (q,T2))|r <span class="keyword">by</span> A4, <span class="reference">TREES_1:def 6</span>;
<a class='lineno' href='#line-1038' id='line-1038'>1038</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-1039' id='line-1039'>1039</a> A2: p <span class="keyword">in</span> (T with-replacement (q,T2))|r <span class="keyword">implies</span> p <span class="keyword">in</span> T|r
<a class='lineno' href='#line-1040' id='line-1040'>1040</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-1041' id='line-1041'>1041</a>     <span class="keyword">assume</span> p <span class="keyword">in</span> (T with-replacement (q,T2))|r;
<a class='lineno' href='#line-1042' id='line-1042'>1042</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-1043' id='line-1043'>1043</a>   A8: r^p <span class="keyword">in</span> T with-replacement (q,T2) <span class="keyword">by</span> A4, <span class="reference">TREES_1:def 6</span>;
<a class='lineno' href='#line-1044' id='line-1044'>1044</a>     r^p <span class="keyword">in</span> T
<a class='lineno' href='#line-1045' id='line-1045'>1045</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-1046' id='line-1046'>1046</a> <span class="set-keyword">      <span class="keyword">set</span></span> rp = r^p;
<a class='lineno' href='#line-1047' id='line-1047'>1047</a>     A9: (rp <span class="keyword">in</span> T &amp; <span class="keyword">not</span> q is_a_proper_prefix_of rp) <span class="keyword">or</span>
<a class='lineno' href='#line-1048' id='line-1048'>1048</a>         (<span class="keyword">ex</span> r2 <span class="keyword">st</span> r2 <span class="keyword">in</span> T2 &amp; rp = q^r2)
<a class='lineno' href='#line-1049' id='line-1049'>1049</a>           <span class="keyword">by</span> A5, A8, <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-1050' id='line-1050'>1050</a>       rp <span class="keyword">in</span> T &amp; <span class="keyword">not</span> q is_a_proper_prefix_of rp
<a class='lineno' href='#line-1051' id='line-1051'>1051</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-1052' id='line-1052'>1052</a>         <span class="keyword">assume</span> <span class="keyword">not</span> <span class="keyword">thesis</span>;
<a class='lineno' href='#line-1053' id='line-1053'>1053</a>         <span class="keyword">then</span> <span class="keyword">ex</span> r2 <span class="keyword">st</span> r2 <span class="keyword">in</span> T2 &amp; rp = q^r2 <span class="keyword">by</span> A9;
<a class='lineno' href='#line-1054' id='line-1054'>1054</a>         <span class="keyword">then</span> <span class="keyword">consider</span> r2 <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-1055' id='line-1055'>1055</a>       A10: r2 <span class="keyword">in</span> T2 <span class="keyword">and</span>
<a class='lineno' href='#line-1056' id='line-1056'>1056</a>       A11: rp = q^r2;
<a class='lineno' href='#line-1057' id='line-1057'>1057</a>         q is_a_prefix_of rp <span class="keyword">by</span> A11, <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-1058' id='line-1058'>1058</a>         <span class="keyword">then</span> q,r^p are_c=-comparable <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 9</span>;
<a class='lineno' href='#line-1059' id='line-1059'>1059</a>         <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A13;
<a class='lineno' href='#line-1060' id='line-1060'>1060</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-1061' id='line-1061'>1061</a>       <span class="keyword">hence</span> r^p <span class="keyword">in</span> T;
<a class='lineno' href='#line-1062' id='line-1062'>1062</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-1063' id='line-1063'>1063</a>     <span class="keyword">hence</span> p <span class="keyword">in</span> T|r <span class="keyword">by</span> A3, <span class="reference">TREES_1:def 6</span>;
<a class='lineno' href='#line-1064' id='line-1064'>1064</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-1065' id='line-1065'>1065</a>   <span class="keyword">thus</span> <span class="keyword">thesis</span> <span class="keyword">by</span> A1, A2, <span class="reference">TREES_2:def 1</span>;
<a class='lineno' href='#line-1066' id='line-1066'>1066</a> <span class="keyword">end</span></span>;
<a class='lineno' href='#line-1067' id='line-1067'>1067</a> 
<a class='lineno' href='#line-1068' id='line-1068'>1068</a> <span class="keyword">reserve</span> q,r <span class="keyword">for</span> Element <span class="keyword">of</span> dom D;
<a class='lineno' href='#line-1069' id='line-1069'>1069</a> 
<a class='lineno' href='#line-1070' id='line-1070'>1070</a> <span class="keyword">theorem</span> Th5:
<a class='lineno' href='#line-1071' id='line-1071'>1071</a>     <span class="keyword">not</span> q,r are_c=-comparable
<a class='lineno' href='#line-1072' id='line-1072'>1072</a>   <span class="keyword">implies</span>
<a class='lineno' href='#line-1073' id='line-1073'>1073</a>     D|r = (D with-replacement (q,D2))|r
<a class='lineno' href='#line-1074' id='line-1074'>1074</a> <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-1075' id='line-1075'>1075</a> <span class="set-keyword">  <span class="keyword">set</span></span> E = D with-replacement (q,D2);
<a class='lineno' href='#line-1076' id='line-1076'>1076</a> 
<a class='lineno' href='#line-1077' id='line-1077'>1077</a> A2: q <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-1078' id='line-1078'>1078</a> A3: r <span class="keyword">in</span> dom D;
<a class='lineno' href='#line-1079' id='line-1079'>1079</a> 
<a class='lineno' href='#line-1080' id='line-1080'>1080</a>   <span class="keyword">assume</span>
<a class='lineno' href='#line-1081' id='line-1081'>1081</a> A1: <span class="keyword">not</span> q,r are_c=-comparable;
<a class='lineno' href='#line-1082' id='line-1082'>1082</a>   <span class="keyword">then</span>
<a class='lineno' href='#line-1083' id='line-1083'>1083</a> A11: <span class="keyword">not</span> q,r^p are_c=-comparable <span class="keyword">by</span> Th7;
<a class='lineno' href='#line-1084' id='line-1084'>1084</a> 
<a class='lineno' href='#line-1085' id='line-1085'>1085</a> A4: dom (D|r) = (dom D)|r <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>
<a class='lineno' href='#line-1086' id='line-1086'>1086</a>              .= ((dom D) with-replacement (q,dom D2))|r <span class="keyword">by</span> A1, A2, A3, Th4
<a class='lineno' href='#line-1087' id='line-1087'>1087</a>              .= (dom (D with-replacement (q,D2)))|r <span class="keyword">by</span> A2, <span class="reference">TREES_2:def 11</span>
<a class='lineno' href='#line-1088' id='line-1088'>1088</a>              .= dom ((D with-replacement (q,D2))|r) <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>
<a class='lineno' href='#line-1089' id='line-1089'>1089</a>              .= dom (E|r);
<a class='lineno' href='#line-1090' id='line-1090'>1090</a> 
<a class='lineno' href='#line-1091' id='line-1091'>1091</a> A5: <span class="keyword">for</span> p <span class="keyword">being</span> Node <span class="keyword">of</span> D|r <span class="keyword">holds</span> (D|r).p = (E|r).p
<a class='lineno' href='#line-1092' id='line-1092'>1092</a>   <span class="keyword">proof</span>
<a class='lineno' href='#line-1093' id='line-1093'>1093</a>     <span class="keyword">let</span> p <span class="keyword">be</span> Node <span class="keyword">of</span> D|r;
<a class='lineno' href='#line-1094' id='line-1094'>1094</a> <span class="set-keyword">    <span class="keyword">set</span></span> rp = r^p;
<a class='lineno' href='#line-1095' id='line-1095'>1095</a>   A6: p <span class="keyword">in</span> dom (D|r);
<a class='lineno' href='#line-1096' id='line-1096'>1096</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-1097' id='line-1097'>1097</a>   A15: p <span class="keyword">in</span> (dom D)|r <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-1098' id='line-1098'>1098</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-1099' id='line-1099'>1099</a>   A12: (D|r).p = D.rp <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-1100' id='line-1100'>1100</a> 
<a class='lineno' href='#line-1101' id='line-1101'>1101</a>     p <span class="keyword">in</span> dom (E|r) <span class="keyword">by</span> A4, A6;
<a class='lineno' href='#line-1102' id='line-1102'>1102</a>     <span class="keyword">then</span> p <span class="keyword">in</span> (dom E)|r <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-1103' id='line-1103'>1103</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-1104' id='line-1104'>1104</a>   A13: (E|r).p = E.rp <span class="keyword">by</span> <span class="reference">TREES_2:def 10</span>;
<a class='lineno' href='#line-1105' id='line-1105'>1105</a> 
<a class='lineno' href='#line-1106' id='line-1106'>1106</a>     rp <span class="keyword">in</span> (dom D) with-replacement (q,dom D2)
<a class='lineno' href='#line-1107' id='line-1107'>1107</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-1108' id='line-1108'>1108</a>       <span class="keyword">not</span> q,rp are_c=-comparable <span class="keyword">by</span> A11;
<a class='lineno' href='#line-1109' id='line-1109'>1109</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-1110' id='line-1110'>1110</a>     A14: <span class="keyword">not</span> q is_a_proper_prefix_of rp <span class="keyword">by</span> Th6;
<a class='lineno' href='#line-1111' id='line-1111'>1111</a>       p <span class="keyword">in</span> (dom D)|r <span class="keyword">by</span> A15;
<a class='lineno' href='#line-1112' id='line-1112'>1112</a>       <span class="keyword">then</span> rp <span class="keyword">in</span> dom D <span class="keyword">by</span> <span class="reference">TREES_1:def 6</span>;
<a class='lineno' href='#line-1113' id='line-1113'>1113</a>       <span class="keyword">hence</span> <span class="keyword">thesis</span> <span class="keyword">by</span> A2, A14, <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-1114' id='line-1114'>1114</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-1115' id='line-1115'>1115</a>     <span class="keyword">then</span>
<a class='lineno' href='#line-1116' id='line-1116'>1116</a>   A7: (<span class="keyword">not</span> q is_a_prefix_of rp &amp; E.rp = D.rp) <span class="keyword">or</span>
<a class='lineno' href='#line-1117' id='line-1117'>1117</a>       (<span class="keyword">ex</span> r2 <span class="keyword">st</span> r2 <span class="keyword">in</span> dom D2 &amp; rp = q^r2 &amp; E.rp = D2.r2)
<a class='lineno' href='#line-1118' id='line-1118'>1118</a>         <span class="keyword">by</span> A2, <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-1119' id='line-1119'>1119</a>     <span class="keyword">not</span> q is_a_prefix_of rp &amp; E.rp = D.rp
<a class='lineno' href='#line-1120' id='line-1120'>1120</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-1121' id='line-1121'>1121</a>       <span class="keyword">assume</span> <span class="keyword">not</span> <span class="keyword">thesis</span>;
<a class='lineno' href='#line-1122' id='line-1122'>1122</a>       <span class="keyword">then</span> <span class="keyword">ex</span> r2 <span class="keyword">st</span> r2 <span class="keyword">in</span> dom D2 &amp; rp = q^r2 &amp; E.rp = D2.r2 <span class="keyword">by</span> A7;
<a class='lineno' href='#line-1123' id='line-1123'>1123</a>       <span class="keyword">then</span> <span class="keyword">consider</span> r2 <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-1124' id='line-1124'>1124</a>     A8: r2 <span class="keyword">in</span> dom D2 <span class="keyword">and</span>
<a class='lineno' href='#line-1125' id='line-1125'>1125</a>     A9: rp = q^r2 <span class="keyword">and</span>
<a class='lineno' href='#line-1126' id='line-1126'>1126</a>     A10: E.rp = D2.r2;
<a class='lineno' href='#line-1127' id='line-1127'>1127</a>       q is_a_prefix_of rp <span class="keyword">by</span> A9, <span class="reference">TREES_1:1</span>;
<a class='lineno' href='#line-1128' id='line-1128'>1128</a>       <span class="keyword">then</span> q,r^p are_c=-comparable <span class="keyword">by</span> <span class="reference">XBOOLE_0:def 9</span>;
<a class='lineno' href='#line-1129' id='line-1129'>1129</a>       <span class="keyword">hence</span> <span class="keyword">contradiction</span> <span class="keyword">by</span> A11;
<a class='lineno' href='#line-1130' id='line-1130'>1130</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-1131' id='line-1131'>1131</a>     <span class="keyword">then</span> E.rp = D.rp;
<a class='lineno' href='#line-1132' id='line-1132'>1132</a>     <span class="keyword">hence</span> (D|r).p = (E|r).p <span class="keyword">by</span> A12, A13;
<a class='lineno' href='#line-1133' id='line-1133'>1133</a>   <span class="keyword">end</span>;
<a class='lineno' href='#line-1134' id='line-1134'>1134</a> 
<a class='lineno' href='#line-1135' id='line-1135'>1135</a>   <span class="keyword">thus</span> <span class="keyword">thesis</span> <span class="keyword">by</span> A4, A5, <span class="reference">TREES_4:def 1</span>;
<a class='lineno' href='#line-1136' id='line-1136'>1136</a> <span class="keyword">end</span></span>;
<a class='lineno' href='#line-1137' id='line-1137'>1137</a> 
<a class='lineno' href='#line-1138' id='line-1138'>1138</a> <span class="keyword">reserve</span> q,r <span class="keyword">for</span> FinSequence <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-1139' id='line-1139'>1139</a> 
<a class='lineno' href='#line-1140' id='line-1140'>1140</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1141' id='line-1141'>1141</a>   <span class="keyword">let</span> v;
<a class='lineno' href='#line-1142' id='line-1142'>1142</a> 
<a class='lineno' href='#line-1143' id='line-1143'>1143</a>   <span class="keyword">func</span> Var(v) -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1144' id='line-1144'>1144</a>     :<span class="reference">Def12</span>:
<a class='lineno' href='#line-1145' id='line-1145'>1145</a>     { &lt;*&gt; NAT } --&gt; v;
<a class='lineno' href='#line-1146' id='line-1146'>1146</a>   <span class="keyword">coherence</span>;
<a class='lineno' href='#line-1147' id='line-1147'>1147</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-19">
              
                <p>Then we can define abstraction and application</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1150' id='line-1150'>1150</a> <span class="comment">::definition</span>
<a class='lineno' href='#line-1151' id='line-1151'>1151</a> <span class="comment">::  func AbsLoc -&gt; FinSequence of NAT equals &lt;*0*&gt;;</span>
<a class='lineno' href='#line-1152' id='line-1152'>1152</a> <span class="comment">::  coherence;</span>
<a class='lineno' href='#line-1153' id='line-1153'>1153</a> <span class="comment">::end;</span>
<a class='lineno' href='#line-1154' id='line-1154'>1154</a> <span class="comment">::</span>
<a class='lineno' href='#line-1155' id='line-1155'>1155</a> <span class="comment">::definition</span>
<a class='lineno' href='#line-1156' id='line-1156'>1156</a> <span class="comment">::  let v,r;</span>
<a class='lineno' href='#line-1157' id='line-1157'>1157</a> <span class="comment">::</span>
<a class='lineno' href='#line-1158' id='line-1158'>1158</a> <span class="comment">::  attr r is v-existingVarPath means</span>
<a class='lineno' href='#line-1159' id='line-1159'>1159</a> <span class="comment">::    :Def19:</span>
<a class='lineno' href='#line-1160' id='line-1160'>1160</a> <span class="comment">::    r is (PreAbstractionTerm v)-existingPath;</span>
<a class='lineno' href='#line-1161' id='line-1161'>1161</a> <span class="comment">::end;</span>
<a class='lineno' href='#line-1162' id='line-1162'>1162</a> <span class="comment">::</span>
<a class='lineno' href='#line-1163' id='line-1163'>1163</a> <span class="comment">::registration</span>
<a class='lineno' href='#line-1164' id='line-1164'>1164</a> <span class="comment">::  let v;</span>
<a class='lineno' href='#line-1165' id='line-1165'>1165</a> <span class="comment">::</span>
<a class='lineno' href='#line-1166' id='line-1166'>1166</a> <span class="comment">::  cluster AbsLoc -&gt; v-existingVarPath;</span></pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-20">
              
                <p>:&gt;                                 *100</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1168' id='line-1168'>1168</a> <span class="comment">::  coherence;</span></pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-21">
              
                <p>:&gt;       *4</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1170' id='line-1170'>1170</a> <span class="comment">::end;</span>
<a class='lineno' href='#line-1171' id='line-1171'>1171</a> 
<a class='lineno' href='#line-1172' id='line-1172'>1172</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1173' id='line-1173'>1173</a>   <span class="keyword">let</span> v,M;
<a class='lineno' href='#line-1174' id='line-1174'>1174</a> 
<a class='lineno' href='#line-1175' id='line-1175'>1175</a>   <span class="keyword">func</span> Abs(v,M) -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1176' id='line-1176'>1176</a>     :<span class="reference">Def20</span>:
<a class='lineno' href='#line-1177' id='line-1177'>1177</a>     (PreAbstractionTerm v) with-replacement (&lt;*0*&gt;, M);
<a class='lineno' href='#line-1178' id='line-1178'>1178</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-1179' id='line-1179'>1179</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-1180' id='line-1180'>1180</a> <span class="set-keyword">    <span class="keyword">set</span></span> e0 = &lt;*0*&gt;;
<a class='lineno' href='#line-1181' id='line-1181'>1181</a>     dom (PreAbstractionTerm v) = { {}, &lt;*0*&gt; } <span class="keyword">by</span> <span class="reference">FUNCOP_1:13</span>;
<a class='lineno' href='#line-1182' id='line-1182'>1182</a>     <span class="keyword">then</span> e0 <span class="keyword">in</span> dom (PreAbstractionTerm v) <span class="keyword">by</span> <span class="reference">TARSKI:def 2</span>;
<a class='lineno' href='#line-1183' id='line-1183'>1183</a>     <span class="keyword">then</span> <span class="keyword">reconsider</span> e0 <span class="keyword">as</span> Element <span class="keyword">of</span> dom (PreAbstractionTerm v);
<a class='lineno' href='#line-1184' id='line-1184'>1184</a>     (PreAbstractionTerm v) with-replacement (e0, M) <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-1185' id='line-1185'>1185</a>     <span class="keyword">hence</span> (PreAbstractionTerm v) with-replacement (&lt;*0*&gt;, M) <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-1186' id='line-1186'>1186</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-1187' id='line-1187'>1187</a> 
<a class='lineno' href='#line-1188' id='line-1188'>1188</a> <span class="comment">::  func Abs(v,M) -&gt; LambdaTerm means</span>
<a class='lineno' href='#line-1189' id='line-1189'>1189</a> <span class="comment">::    it,(&lt;*&gt; NAT) abstracts v &amp;</span>
<a class='lineno' href='#line-1190' id='line-1190'>1190</a> <span class="comment">::    it|&lt;*0*&gt; = M &amp;</span>
<a class='lineno' href='#line-1191' id='line-1191'>1191</a> <span class="comment">::    not &lt;*1*&gt; in dom it;</span>
<a class='lineno' href='#line-1192' id='line-1192'>1192</a> <span class="comment">::  existence</span>
<a class='lineno' href='#line-1193' id='line-1193'>1193</a> <span class="comment">::  proof</span>
<a class='lineno' href='#line-1194' id='line-1194'>1194</a> <span class="comment">::    set e = &lt;*&gt; NAT;</span>
<a class='lineno' href='#line-1195' id='line-1195'>1195</a> <span class="comment">::    set e0 = &lt;*0*&gt;;</span>
<a class='lineno' href='#line-1196' id='line-1196'>1196</a> <span class="comment">::    set e1 = &lt;*1*&gt;;</span>
<a class='lineno' href='#line-1197' id='line-1197'>1197</a> <span class="comment">::  A3: not e0,e1 are_c=-comparable</span>
<a class='lineno' href='#line-1198' id='line-1198'>1198</a> <span class="comment">::    proof</span>
<a class='lineno' href='#line-1199' id='line-1199'>1199</a> <span class="comment">::      assume e0,e1 are_c=-comparable;</span>
<a class='lineno' href='#line-1200' id='line-1200'>1200</a> <span class="comment">::      then 0 = 1 by TREES_1:5;</span>
<a class='lineno' href='#line-1201' id='line-1201'>1201</a> <span class="comment">::      hence contradiction;</span>
<a class='lineno' href='#line-1202' id='line-1202'>1202</a> <span class="comment">::    end;</span>
<a class='lineno' href='#line-1203' id='line-1203'>1203</a> <span class="comment">::</span>
<a class='lineno' href='#line-1204' id='line-1204'>1204</a> <span class="comment">::  A6: dom (PreAbstractionTerm v) = { {}, &lt;*0*&gt; } by FUNCOP_1:13;</span>
<a class='lineno' href='#line-1205' id='line-1205'>1205</a> <span class="comment">::    then &lt;*0*&gt; in dom (PreAbstractionTerm v) by TARSKI:def 2;</span>
<a class='lineno' href='#line-1206' id='line-1206'>1206</a> <span class="comment">::    then reconsider e0 as Element of dom (PreAbstractionTerm v);</span>
<a class='lineno' href='#line-1207' id='line-1207'>1207</a> <span class="comment">::    set D = (PreAbstractionTerm v) with-replacement (e0, M);</span>
<a class='lineno' href='#line-1208' id='line-1208'>1208</a> <span class="comment">::</span>
<a class='lineno' href='#line-1209' id='line-1209'>1209</a> <span class="comment">::    take D;</span>
<a class='lineno' href='#line-1210' id='line-1210'>1210</a> <span class="comment">::    thus D,e abstracts v</span>
<a class='lineno' href='#line-1211' id='line-1211'>1211</a> <span class="comment">::    proof</span>
<a class='lineno' href='#line-1212' id='line-1212'>1212</a> <span class="comment">::      thus thesis;</span></pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-22">
              
                <p>:&gt;             *4</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1214' id='line-1214'>1214</a> <span class="comment">::    end;</span>
<a class='lineno' href='#line-1215' id='line-1215'>1215</a> <span class="comment">::</span>
<a class='lineno' href='#line-1216' id='line-1216'>1216</a> <span class="comment">::    thus D|&lt;*0*&gt; = M by Th3;</span>
<a class='lineno' href='#line-1217' id='line-1217'>1217</a> <span class="comment">::    thus not &lt;*1*&gt; in dom D</span>
<a class='lineno' href='#line-1218' id='line-1218'>1218</a> <span class="comment">::    proof</span>
<a class='lineno' href='#line-1219' id='line-1219'>1219</a> <span class="comment">::      assume e1 in dom D;</span>
<a class='lineno' href='#line-1220' id='line-1220'>1220</a> <span class="comment">::      then e1 in (dom (PreAbstractionTerm v)) with-replacement (e0, dom M)</span>
<a class='lineno' href='#line-1221' id='line-1221'>1221</a> <span class="comment">::        by TREES_2:def 11;</span>
<a class='lineno' href='#line-1222' id='line-1222'>1222</a> <span class="comment">::      then</span>
<a class='lineno' href='#line-1223' id='line-1223'>1223</a> <span class="comment">::    A4: (e1 in (dom (PreAbstractionTerm v)) &amp; not e0 is_a_proper_prefix_of e1)</span>
<a class='lineno' href='#line-1224' id='line-1224'>1224</a> <span class="comment">::     or (ex r st r in dom M &amp; e1 = e0^r)</span>
<a class='lineno' href='#line-1225' id='line-1225'>1225</a> <span class="comment">::        by TREES_1:def 9;</span>
<a class='lineno' href='#line-1226' id='line-1226'>1226</a> <span class="comment">::      (e1 in (dom (PreAbstractionTerm v)) &amp; not e0 is_a_proper_prefix_of e1)</span>
<a class='lineno' href='#line-1227' id='line-1227'>1227</a> <span class="comment">::      proof</span>
<a class='lineno' href='#line-1228' id='line-1228'>1228</a> <span class="comment">::        assume not thesis;</span>
<a class='lineno' href='#line-1229' id='line-1229'>1229</a> <span class="comment">::        then (ex r st r in dom M &amp; e1 = e0^r) by A4;</span>
<a class='lineno' href='#line-1230' id='line-1230'>1230</a> <span class="comment">::        then consider r such that r in dom M and</span>
<a class='lineno' href='#line-1231' id='line-1231'>1231</a> <span class="comment">::      A2: e1 = e0^r;</span>
<a class='lineno' href='#line-1232' id='line-1232'>1232</a> <span class="comment">::        e0 is_a_prefix_of e1 by A2, TREES_1:1;</span>
<a class='lineno' href='#line-1233' id='line-1233'>1233</a> <span class="comment">::        then e0,e1 are_c=-comparable by XBOOLE_0:def 9;</span>
<a class='lineno' href='#line-1234' id='line-1234'>1234</a> <span class="comment">::        hence contradiction by A3;</span>
<a class='lineno' href='#line-1235' id='line-1235'>1235</a> <span class="comment">::      end;</span>
<a class='lineno' href='#line-1236' id='line-1236'>1236</a> <span class="comment">::      then</span>
<a class='lineno' href='#line-1237' id='line-1237'>1237</a> <span class="comment">::    A5: e1 in (dom (PreAbstractionTerm v));</span>
<a class='lineno' href='#line-1238' id='line-1238'>1238</a> <span class="comment">::      then</span>
<a class='lineno' href='#line-1239' id='line-1239'>1239</a> <span class="comment">::    A7: e1 = {} or e1 = &lt;*0*&gt; by A6, TARSKI:def 2;</span>
<a class='lineno' href='#line-1240' id='line-1240'>1240</a> <span class="comment">::      per cases;</span>
<a class='lineno' href='#line-1241' id='line-1241'>1241</a> <span class="comment">::      suppose e1 = {};</span>
<a class='lineno' href='#line-1242' id='line-1242'>1242</a> <span class="comment">::        then e1 is empty;</span>
<a class='lineno' href='#line-1243' id='line-1243'>1243</a> <span class="comment">::        hence contradiction;</span>
<a class='lineno' href='#line-1244' id='line-1244'>1244</a> <span class="comment">::      end;</span>
<a class='lineno' href='#line-1245' id='line-1245'>1245</a> <span class="comment">::      suppose not e1 = {};</span>
<a class='lineno' href='#line-1246' id='line-1246'>1246</a> <span class="comment">::        then e1 = &lt;*0*&gt; by A7;</span>
<a class='lineno' href='#line-1247' id='line-1247'>1247</a> <span class="comment">::        then</span>
<a class='lineno' href='#line-1248' id='line-1248'>1248</a> <span class="comment">::      A8: e1.1 = 0 by FINSEQ_1:40;</span>
<a class='lineno' href='#line-1249' id='line-1249'>1249</a> <span class="comment">::        e1.1 = 1 by FINSEQ_1:40;</span>
<a class='lineno' href='#line-1250' id='line-1250'>1250</a> <span class="comment">::        hence contradiction by A8;</span>
<a class='lineno' href='#line-1251' id='line-1251'>1251</a> <span class="comment">::      end;</span>
<a class='lineno' href='#line-1252' id='line-1252'>1252</a> <span class="comment">::    end;</span>
<a class='lineno' href='#line-1253' id='line-1253'>1253</a> <span class="comment">::  end;</span>
<a class='lineno' href='#line-1254' id='line-1254'>1254</a> <span class="comment">::  uniqueness;</span></pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-23">
              
                <p>:&gt;        *4</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1256' id='line-1256'>1256</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-1257' id='line-1257'>1257</a> 
<a class='lineno' href='#line-1258' id='line-1258'>1258</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1259' id='line-1259'>1259</a>   <span class="keyword">let</span> M,N;
<a class='lineno' href='#line-1260' id='line-1260'>1260</a> 
<a class='lineno' href='#line-1261' id='line-1261'>1261</a>   <span class="keyword">func</span> App(M,N) -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1262' id='line-1262'>1262</a>     :<span class="reference">Def21</span>:
<a class='lineno' href='#line-1263' id='line-1263'>1263</a>     (PreApplicationTerm
<a class='lineno' href='#line-1264' id='line-1264'>1264</a>       with-replacement (&lt;*0*&gt;, M)
<a class='lineno' href='#line-1265' id='line-1265'>1265</a>     )
<a class='lineno' href='#line-1266' id='line-1266'>1266</a>       with-replacement (&lt;*1*&gt;, N);
<a class='lineno' href='#line-1267' id='line-1267'>1267</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-1268' id='line-1268'>1268</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-1269' id='line-1269'>1269</a> <span class="set-keyword">    <span class="keyword">set</span></span> e0 = &lt;*0*&gt;;
<a class='lineno' href='#line-1270' id='line-1270'>1270</a> <span class="set-keyword">    <span class="keyword">set</span></span> e1 = &lt;*1*&gt;;
<a class='lineno' href='#line-1271' id='line-1271'>1271</a>   A5: <span class="keyword">not</span> e0,e1 are_c=-comparable
<a class='lineno' href='#line-1272' id='line-1272'>1272</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-1273' id='line-1273'>1273</a>       <span class="keyword">assume</span> e0,e1 are_c=-comparable;
<a class='lineno' href='#line-1274' id='line-1274'>1274</a>       <span class="keyword">then</span> 0 = 1 <span class="keyword">by</span> <span class="reference">TREES_1:5</span>;
<a class='lineno' href='#line-1275' id='line-1275'>1275</a>       <span class="keyword">hence</span> <span class="keyword">contradiction</span>;
<a class='lineno' href='#line-1276' id='line-1276'>1276</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-1277' id='line-1277'>1277</a>   A4: <span class="keyword">not</span> e0 is_a_proper_prefix_of e1 <span class="keyword">by</span> A5, Th6;
<a class='lineno' href='#line-1278' id='line-1278'>1278</a> 
<a class='lineno' href='#line-1279' id='line-1279'>1279</a>   A2: dom PreApplicationTerm = { {}, &lt;*0*&gt;, &lt;*1*&gt; } <span class="keyword">by</span> <span class="reference">FUNCOP_1:13</span>;
<a class='lineno' href='#line-1280' id='line-1280'>1280</a>     <span class="keyword">then</span> e0 <span class="keyword">in</span> dom PreApplicationTerm <span class="keyword">by</span> <span class="reference">ENUMSET1:def 1</span>;
<a class='lineno' href='#line-1281' id='line-1281'>1281</a>     <span class="keyword">then</span> <span class="keyword">reconsider</span> e0 <span class="keyword">as</span> Element <span class="keyword">of</span> dom PreApplicationTerm;
<a class='lineno' href='#line-1282' id='line-1282'>1282</a> <span class="set-keyword">    <span class="keyword">set</span></span> Pre2 = PreApplicationTerm with-replacement (e0, M);
<a class='lineno' href='#line-1283' id='line-1283'>1283</a>     Pre2 <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-1284' id='line-1284'>1284</a> 
<a class='lineno' href='#line-1285' id='line-1285'>1285</a>   A1: dom Pre2 = (dom PreApplicationTerm) with-replacement (e0, dom M)
<a class='lineno' href='#line-1286' id='line-1286'>1286</a>       <span class="keyword">by</span> <span class="reference">TREES_2:def 11</span>;
<a class='lineno' href='#line-1287' id='line-1287'>1287</a>   A3: e1 <span class="keyword">in</span> dom PreApplicationTerm <span class="keyword">by</span> A2, <span class="reference">ENUMSET1:def 1</span>;
<a class='lineno' href='#line-1288' id='line-1288'>1288</a>     e1 <span class="keyword">in</span> dom Pre2 <span class="keyword">by</span> A1, A3, A4, <span class="reference">TREES_1:def 9</span>;
<a class='lineno' href='#line-1289' id='line-1289'>1289</a>     <span class="keyword">then</span> <span class="keyword">reconsider</span> e1 <span class="keyword">as</span> Element <span class="keyword">of</span> dom Pre2;
<a class='lineno' href='#line-1290' id='line-1290'>1290</a> <span class="set-keyword">    <span class="keyword">set</span></span> Final = Pre2 with-replacement (e1, N);
<a class='lineno' href='#line-1291' id='line-1291'>1291</a>     Final <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-1292' id='line-1292'>1292</a> 
<a class='lineno' href='#line-1293' id='line-1293'>1293</a>     <span class="keyword">hence</span> (PreApplicationTerm with-replacement (&lt;*0*&gt;, M))
<a class='lineno' href='#line-1294' id='line-1294'>1294</a>       with-replacement (&lt;*1*&gt;, N) <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-1295' id='line-1295'>1295</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-1296' id='line-1296'>1296</a> 
<a class='lineno' href='#line-1297' id='line-1297'>1297</a> <span class="comment">::  func App(M,N) -&gt; LambdaTerm means</span>
<a class='lineno' href='#line-1298' id='line-1298'>1298</a> <span class="comment">::    it|&lt;*0*&gt; = M &amp; it|&lt;*1*&gt; = N;</span>
<a class='lineno' href='#line-1299' id='line-1299'>1299</a> <span class="comment">::  existence</span>
<a class='lineno' href='#line-1300' id='line-1300'>1300</a> <span class="comment">::  proof</span>
<a class='lineno' href='#line-1301' id='line-1301'>1301</a> <span class="comment">::    set e0 = &lt;*0*&gt;;</span>
<a class='lineno' href='#line-1302' id='line-1302'>1302</a> <span class="comment">::    set e1 = &lt;*1*&gt;;</span>
<a class='lineno' href='#line-1303' id='line-1303'>1303</a> <span class="comment">::  A3: not e0,e1 are_c=-comparable</span>
<a class='lineno' href='#line-1304' id='line-1304'>1304</a> <span class="comment">::    proof</span>
<a class='lineno' href='#line-1305' id='line-1305'>1305</a> <span class="comment">::      assume e0,e1 are_c=-comparable;</span>
<a class='lineno' href='#line-1306' id='line-1306'>1306</a> <span class="comment">::      then 0 = 1 by TREES_1:5;</span>
<a class='lineno' href='#line-1307' id='line-1307'>1307</a> <span class="comment">::      hence contradiction;</span>
<a class='lineno' href='#line-1308' id='line-1308'>1308</a> <span class="comment">::    end;</span>
<a class='lineno' href='#line-1309' id='line-1309'>1309</a> <span class="comment">::  A4: not e0 is_a_proper_prefix_of e1 by A3, Th6;</span>
<a class='lineno' href='#line-1310' id='line-1310'>1310</a> <span class="comment">::</span>
<a class='lineno' href='#line-1311' id='line-1311'>1311</a> <span class="comment">::    dom PreApplicationTerm = { {}, &lt;*0*&gt;, &lt;*1*&gt; } by FUNCOP_1:13;</span>
<a class='lineno' href='#line-1312' id='line-1312'>1312</a> <span class="comment">::    then</span>
<a class='lineno' href='#line-1313' id='line-1313'>1313</a> <span class="comment">::  A7: &lt;*0*&gt; in dom PreApplicationTerm by ENUMSET1:def 1;</span>
<a class='lineno' href='#line-1314' id='line-1314'>1314</a> <span class="comment">::    then reconsider e0 as Element of dom PreApplicationTerm;</span>
<a class='lineno' href='#line-1315' id='line-1315'>1315</a> <span class="comment">::    set preD = PreApplicationTerm with-replacement (e0, M);</span>
<a class='lineno' href='#line-1316' id='line-1316'>1316</a> <span class="comment">::    preD is LambdaTerm;</span>
<a class='lineno' href='#line-1317' id='line-1317'>1317</a> <span class="comment">::</span>
<a class='lineno' href='#line-1318' id='line-1318'>1318</a> <span class="comment">::  A1: dom preD = (dom PreApplicationTerm) with-replacement (e0, dom M)</span>
<a class='lineno' href='#line-1319' id='line-1319'>1319</a> <span class="comment">::      by TREES_2:def 11;</span>
<a class='lineno' href='#line-1320' id='line-1320'>1320</a> <span class="comment">::    dom PreApplicationTerm = { {}, &lt;*0*&gt;, &lt;*1*&gt; } by FUNCOP_1:13;</span>
<a class='lineno' href='#line-1321' id='line-1321'>1321</a> <span class="comment">::    then</span>
<a class='lineno' href='#line-1322' id='line-1322'>1322</a> <span class="comment">::  A2: &lt;*1*&gt; in dom PreApplicationTerm by ENUMSET1:def 1;</span>
<a class='lineno' href='#line-1323' id='line-1323'>1323</a> <span class="comment">::    &lt;*1*&gt; in dom preD by A1, A2, A4, TREES_1:def 9;</span>
<a class='lineno' href='#line-1324' id='line-1324'>1324</a> <span class="comment">::    then reconsider e1 as Element of dom preD;</span>
<a class='lineno' href='#line-1325' id='line-1325'>1325</a> <span class="comment">::    set D = preD with-replacement (e1, N);</span>
<a class='lineno' href='#line-1326' id='line-1326'>1326</a> <span class="comment">::    D is LambdaTerm;</span>
<a class='lineno' href='#line-1327' id='line-1327'>1327</a> <span class="comment">::</span>
<a class='lineno' href='#line-1328' id='line-1328'>1328</a> <span class="comment">::  A6: e0 in dom preD</span>
<a class='lineno' href='#line-1329' id='line-1329'>1329</a> <span class="comment">::    proof</span>
<a class='lineno' href='#line-1330' id='line-1330'>1330</a> <span class="comment">::    A8: e0 in dom PreApplicationTerm by A7;</span>
<a class='lineno' href='#line-1331' id='line-1331'>1331</a> <span class="comment">::      not e0 is_a_proper_prefix_of e0;</span>
<a class='lineno' href='#line-1332' id='line-1332'>1332</a> <span class="comment">::      then e0 in (dom PreApplicationTerm) with-replacement (e0, dom M)</span>
<a class='lineno' href='#line-1333' id='line-1333'>1333</a> <span class="comment">::        by A8, TREES_1:def 9;</span>
<a class='lineno' href='#line-1334' id='line-1334'>1334</a> <span class="comment">::      hence thesis by A1, TREES_2:def 11;</span>
<a class='lineno' href='#line-1335' id='line-1335'>1335</a> <span class="comment">::    end;</span>
<a class='lineno' href='#line-1336' id='line-1336'>1336</a> <span class="comment">::  A5: e0 in dom D</span>
<a class='lineno' href='#line-1337' id='line-1337'>1337</a> <span class="comment">::    proof</span>
<a class='lineno' href='#line-1338' id='line-1338'>1338</a> <span class="comment">::    A9: e0 in dom preD by A6;</span>
<a class='lineno' href='#line-1339' id='line-1339'>1339</a> <span class="comment">::      not e1 is_a_proper_prefix_of e0 by A3, Th6;</span>
<a class='lineno' href='#line-1340' id='line-1340'>1340</a> <span class="comment">::      then e0 in (dom preD) with-replacement (e1, dom N)</span>
<a class='lineno' href='#line-1341' id='line-1341'>1341</a> <span class="comment">::        by A9, TREES_1:def 9;</span>
<a class='lineno' href='#line-1342' id='line-1342'>1342</a> <span class="comment">::      hence thesis by A1, TREES_2:def 11;</span>
<a class='lineno' href='#line-1343' id='line-1343'>1343</a> <span class="comment">::    end;</span>
<a class='lineno' href='#line-1344' id='line-1344'>1344</a> <span class="comment">::</span>
<a class='lineno' href='#line-1345' id='line-1345'>1345</a> <span class="comment">::    take D;</span>
<a class='lineno' href='#line-1346' id='line-1346'>1346</a> <span class="comment">::    thus D|&lt;*0*&gt; = preD|&lt;*0*&gt; by A3, A5, A6, Th5</span>
<a class='lineno' href='#line-1347' id='line-1347'>1347</a> <span class="comment">::                .= M by Th3;</span>
<a class='lineno' href='#line-1348' id='line-1348'>1348</a> <span class="comment">::    thus D|&lt;*1*&gt; = N by Th3;</span>
<a class='lineno' href='#line-1349' id='line-1349'>1349</a> <span class="comment">::  end;</span>
<a class='lineno' href='#line-1350' id='line-1350'>1350</a> <span class="comment">::  uniqueness;</span></pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-24">
              
                <p>:&gt;        *4</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1352' id='line-1352'>1352</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-25">
              
                <h3 id="hd-1.3">
                  
                  <a href="#hd-1.3" class="headnumber">
                    1.3
                  </a>
                  
                  Substitution
                </h3>
              

              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-26">
              
                
              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1356' id='line-1356'>1356</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1357' id='line-1357'>1357</a>   <span class="keyword">let</span> N,M,v;
<a class='lineno' href='#line-1358' id='line-1358'>1358</a> 
<a class='lineno' href='#line-1359' id='line-1359'>1359</a>   <span class="keyword">redefine</span> <span class="keyword">func</span> (N,v) &lt;- M -&gt; LambdaTerm;
<a class='lineno' href='#line-1360' id='line-1360'>1360</a>   <span class="keyword">coherence</span>
<a class='lineno' href='#line-1361' id='line-1361'>1361</a>   <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-1362' id='line-1362'>1362</a> <span class="set-keyword">    <span class="keyword">set</span></span> P = (N,v) &lt;- M;
<a class='lineno' href='#line-1363' id='line-1363'>1363</a>     P <span class="keyword">is</span> NAT-valued;
<a class='lineno' href='#line-1364' id='line-1364'>1364</a>     <span class="keyword">then</span> <span class="keyword">reconsider</span> P <span class="keyword">as</span> DecoratedTree <span class="keyword">of</span> NAT;
<a class='lineno' href='#line-1365' id='line-1365'>1365</a>     P <span class="keyword">is</span> LambdaTerm-like
<a class='lineno' href='#line-1366' id='line-1366'>1366</a>     <span class="keyword">proof</span>
<a class='lineno' href='#line-1367' id='line-1367'>1367</a>       <span class="comment">:: ? use FINSET_1:sch 2 or FINSET_1:7</span>
<a class='lineno' href='#line-1368' id='line-1368'>1368</a>       <span class="comment">:: ? take a look at TREES_1 reg: T with-replacement (t,T1) -&gt; finite</span>
<a class='lineno' href='#line-1369' id='line-1369'>1369</a>       <span class="keyword">thus</span> dom P <span class="keyword">is</span> finite;
<a class='lineno' href='#line-1370' id='line-1370'>1370</a> <span class="error">::&gt;                      *4</span>
<a class='lineno' href='#line-1371' id='line-1371'>1371</a>       <span class="keyword">let</span> r;
<a class='lineno' href='#line-1372' id='line-1372'>1372</a>       <span class="keyword">assume</span> r <span class="keyword">in</span> dom P;
<a class='lineno' href='#line-1373' id='line-1373'>1373</a>       <span class="keyword">then</span>
<a class='lineno' href='#line-1374' id='line-1374'>1374</a>     A1: (r <span class="keyword">in</span> dom N)
<a class='lineno' href='#line-1375' id='line-1375'>1375</a>         <span class="keyword">or</span> (<span class="keyword">ex</span> q <span class="keyword">being</span> Node <span class="keyword">of</span> N, r2 <span class="keyword">being</span> Node <span class="keyword">of</span> M <span class="keyword">st</span>
<a class='lineno' href='#line-1376' id='line-1376'>1376</a>             q <span class="keyword">in</span> Leaves dom N &amp; N.q = v &amp; r = q^r2)
<a class='lineno' href='#line-1377' id='line-1377'>1377</a>         <span class="keyword">by</span> <span class="reference">TREES_4:def 7</span>;
<a class='lineno' href='#line-1378' id='line-1378'>1378</a>       <span class="keyword">thus</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1}
<a class='lineno' href='#line-1379' id='line-1379'>1379</a>       <span class="keyword">proof</span>
<a class='lineno' href='#line-1380' id='line-1380'>1380</a>         <span class="keyword">per</span> <span class="keyword">cases</span>;
<a class='lineno' href='#line-1381' id='line-1381'>1381</a>         <span class="keyword">suppose</span> r <span class="keyword">in</span> dom N;
<a class='lineno' href='#line-1382' id='line-1382'>1382</a>           <span class="keyword">hence</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-1383' id='line-1383'>1383</a>         <span class="keyword">end</span>;
<a class='lineno' href='#line-1384' id='line-1384'>1384</a>         <span class="keyword">suppose</span> <span class="keyword">not</span> r <span class="keyword">in</span> dom N;
<a class='lineno' href='#line-1385' id='line-1385'>1385</a>           <span class="keyword">then</span> (<span class="keyword">ex</span> q <span class="keyword">being</span> Node <span class="keyword">of</span> N, r2 <span class="keyword">being</span> Node <span class="keyword">of</span> M <span class="keyword">st</span>
<a class='lineno' href='#line-1386' id='line-1386'>1386</a>             q <span class="keyword">in</span> Leaves dom N &amp; N.q = v &amp; r = q^r2) <span class="keyword">by</span> A1;
<a class='lineno' href='#line-1387' id='line-1387'>1387</a>           <span class="keyword">then</span> <span class="keyword">consider</span> q <span class="keyword">being</span> Node <span class="keyword">of</span> N,
<a class='lineno' href='#line-1388' id='line-1388'>1388</a>             r2 <span class="keyword">being</span> Node <span class="keyword">of</span> M <span class="keyword">such</span> <span class="keyword">that</span>
<a class='lineno' href='#line-1389' id='line-1389'>1389</a>         A2: q <span class="keyword">in</span> Leaves dom N <span class="keyword">and</span>
<a class='lineno' href='#line-1390' id='line-1390'>1390</a>         A3: N.q = v <span class="keyword">and</span>
<a class='lineno' href='#line-1391' id='line-1391'>1391</a>         A4: r = q^r2;
<a class='lineno' href='#line-1392' id='line-1392'>1392</a>         A5: q <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-1393' id='line-1393'>1393</a>         A6: r2 <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> <span class="reference">Def1</span>;
<a class='lineno' href='#line-1394' id='line-1394'>1394</a>           <span class="keyword">thus</span> r <span class="keyword">is</span> FinSequence <span class="keyword">of</span> {0,1} <span class="keyword">by</span> A4, A5, A6, <span class="reference">FINSEQ_1:75</span>;
<a class='lineno' href='#line-1395' id='line-1395'>1395</a>         <span class="keyword">end</span>;
<a class='lineno' href='#line-1396' id='line-1396'>1396</a>       <span class="keyword">end</span>;
<a class='lineno' href='#line-1397' id='line-1397'>1397</a> 
<a class='lineno' href='#line-1398' id='line-1398'>1398</a>       <span class="keyword">assume</span> r^&lt;*0*&gt; <span class="keyword">in</span> dom P;
<a class='lineno' href='#line-1399' id='line-1399'>1399</a>       <span class="keyword">assume</span> r^&lt;*1*&gt; <span class="keyword">in</span> dom P;
<a class='lineno' href='#line-1400' id='line-1400'>1400</a>       <span class="keyword">thus</span> P.r = 0;
<a class='lineno' href='#line-1401' id='line-1401'>1401</a> <span class="error">::&gt;              *4</span>
<a class='lineno' href='#line-1402' id='line-1402'>1402</a>     <span class="keyword">end</span>;
<a class='lineno' href='#line-1403' id='line-1403'>1403</a>     <span class="keyword">hence</span> (N,v) &lt;- M <span class="keyword">is</span> LambdaTerm;
<a class='lineno' href='#line-1404' id='line-1404'>1404</a>   <span class="keyword">end</span></span>;
<a class='lineno' href='#line-1405' id='line-1405'>1405</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-27">
              
                <h4 id="hd-1.3.1">
                  
                  <a href="#hd-1.3.1" class="headnumber">
                    1.3.1
                  </a>
                  
                  Substitution lemma
                </h4>
              

              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-28">
              
                <p>(If I have time...)</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1410' id='line-1410'>1410</a> <span class="keyword">theorem</span>
<a class='lineno' href='#line-1411' id='line-1411'>1411</a>   <span class="keyword">not</span> P contains_variable v <span class="keyword">implies</span>
<a class='lineno' href='#line-1412' id='line-1412'>1412</a>     <span class="comment">::M[v := N][w := P] =</span>
<a class='lineno' href='#line-1413' id='line-1413'>1413</a>     (((M,v) &lt;- N),w) &lt;- P =
<a class='lineno' href='#line-1414' id='line-1414'>1414</a>     (((M,w) &lt;- P),v) &lt;- ((N,w) &lt;- P)
<a class='lineno' href='#line-1415' id='line-1415'>1415</a>     <span class="comment">::M[w := P][v := N[w := P]]</span>
<a class='lineno' href='#line-1416' id='line-1416'>1416</a> <a class="keyword toggle-collapsible" href="#">proof</a><span class="collapsible">
<a class='lineno' href='#line-1417' id='line-1417'>1417</a>   <span class="keyword">thus</span> <span class="keyword">thesis</span>;
<a class='lineno' href='#line-1418' id='line-1418'>1418</a> <span class="error">::&gt;         *4</span>
<a class='lineno' href='#line-1419' id='line-1419'>1419</a> <span class="keyword">end</span></span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-29">
              
                <h3 id="hd-1.4">
                  
                  <a href="#hd-1.4" class="headnumber">
                    1.4
                  </a>
                  
                  Reduction and conversion
                </h3>
              

              
                <ul class="vocabulary">
                
                
                <li class="type-pred"><a href="#line-1429"><code>beta-&gt;shallow</code></a></li>
                
                
                <li class="type-pred"><a href="#line-1450"><code>beta-&gt;</code></a></li>
                
                
                <li class="type-pred"><a href="#line-1465"><code>beta-&gt;*</code></a></li>
                
                
                <li class="type-pred"><a href="#line-1474"><code>beta=</code></a></li>
                
                
                <li class="type-func"><a href="#line-1480"><code>cI</code></a></li>
                
                
                <li class="type-func"><a href="#line-1485"><code>cOne</code></a></li>
                
                
                <li class="type-func"><a href="#line-1490"><code>cK</code></a></li>
                
                
                <li class="type-func"><a href="#line-1495"><code>cK*</code></a></li>
                
                
                <li class="type-func"><a href="#line-1500"><code>cDelta</code></a></li>
                
                
                <li class="type-func"><a href="#line-1505"><code>cY</code></a></li>
                
                
                <li class="type-func"><a href="#line-1515"><code>cOmega</code></a></li>
                
                </ul>
              
            </div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-30">
              
                <p>First we define one-step toplevel (<em>shallow</em>) reduction.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1425' id='line-1425'>1425</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1426' id='line-1426'>1426</a>   <span class="keyword">let</span> P,Q;
<a class='lineno' href='#line-1427' id='line-1427'>1427</a>   
<a class='lineno' href='#line-1428' id='line-1428'>1428</a>   <span class="comment">:: P === (\x.N)M --&gt; N[x:=M] === Q</span>
<a class='lineno' href='#line-1429' id='line-1429'>1429</a>   <span class="keyword">pred</span> P beta-&gt;shallow Q <span class="keyword">means</span>
<a class='lineno' href='#line-1430' id='line-1430'>1430</a>     <span class="keyword">ex</span> N,n,M <span class="keyword">st</span>
<a class='lineno' href='#line-1431' id='line-1431'>1431</a>       <span class="comment">:: P === (\x.N)M</span>
<a class='lineno' href='#line-1432' id='line-1432'>1432</a>       P = App(Abs(n,N),M) &amp;
<a class='lineno' href='#line-1433' id='line-1433'>1433</a> 
<a class='lineno' href='#line-1434' id='line-1434'>1434</a>       <span class="comment">:: Q === N[x:=M]</span>
<a class='lineno' href='#line-1435' id='line-1435'>1435</a>       Q = (N,n) &lt;- M;
<a class='lineno' href='#line-1436' id='line-1436'>1436</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-31">
              
                <p>Then we close under subterm reduction to get actual one-step beta reduction.</p>
<p>Note that I had to use a work-around here, where I have two
 set-theoretically identical elements <code>p</code> and <code>q</code>, but considered
 in Mizar as having different types to enable the two <code>|</code> operations
 to work. I also tried defining something like <code>Element of (dom M),(dom N)</code>,
 but this is extremely difficult, if not impossible.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1445' id='line-1445'>1445</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1446' id='line-1446'>1446</a>   <span class="keyword">let</span> M,N;
<a class='lineno' href='#line-1447' id='line-1447'>1447</a> 
<a class='lineno' href='#line-1448' id='line-1448'>1448</a>   <span class="comment">:: TODO better definition with tree operations ?</span>
<a class='lineno' href='#line-1449' id='line-1449'>1449</a> 
<a class='lineno' href='#line-1450' id='line-1450'>1450</a>   <span class="keyword">pred</span> M beta-&gt; N <span class="keyword">means</span>
<a class='lineno' href='#line-1451' id='line-1451'>1451</a>     <span class="keyword">ex</span>
<a class='lineno' href='#line-1452' id='line-1452'>1452</a>       p <span class="keyword">being</span> Element <span class="keyword">of</span> dom M,
<a class='lineno' href='#line-1453' id='line-1453'>1453</a>       q <span class="keyword">being</span> Element <span class="keyword">of</span> dom N <span class="keyword">st</span>
<a class='lineno' href='#line-1454' id='line-1454'>1454</a>         p = q &amp;
<a class='lineno' href='#line-1455' id='line-1455'>1455</a>         M|p beta-&gt;shallow N|q &amp;
<a class='lineno' href='#line-1456' id='line-1456'>1456</a>         <span class="keyword">for</span> q <span class="keyword">st</span> <span class="keyword">not</span> p is_a_prefix_of q <span class="keyword">holds</span>
<a class='lineno' href='#line-1457' id='line-1457'>1457</a>           [r,x] <span class="keyword">in</span> M <span class="keyword">iff</span> [r,x] <span class="keyword">in</span> N;
<a class='lineno' href='#line-1458' id='line-1458'>1458</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-32">
              
                <p>We close under transitivity and reflexivity
 to get full beta reduction.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1462' id='line-1462'>1462</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1463' id='line-1463'>1463</a>   <span class="keyword">let</span> M,N;
<a class='lineno' href='#line-1464' id='line-1464'>1464</a>   
<a class='lineno' href='#line-1465' id='line-1465'>1465</a>   <span class="keyword">pred</span> M beta-&gt;* N <span class="keyword">means</span>
<a class='lineno' href='#line-1466' id='line-1466'>1466</a>     M = N <span class="keyword">or</span>
<a class='lineno' href='#line-1467' id='line-1467'>1467</a>     <span class="keyword">ex</span> P <span class="keyword">st</span> M beta-&gt; P &amp; P beta-&gt; N;
<a class='lineno' href='#line-1468' id='line-1468'>1468</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-33">
              
                <p>And then close under symmetry to get beta conversion.</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1471' id='line-1471'>1471</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1472' id='line-1472'>1472</a>   <span class="keyword">let</span> M,N;
<a class='lineno' href='#line-1473' id='line-1473'>1473</a>   
<a class='lineno' href='#line-1474' id='line-1474'>1474</a>   <span class="keyword">pred</span> M beta= N <span class="keyword">means</span>
<a class='lineno' href='#line-1475' id='line-1475'>1475</a>     M beta-&gt;* N <span class="keyword">or</span> N beta-&gt;* M;
<a class='lineno' href='#line-1476' id='line-1476'>1476</a> <span class="keyword">end</span>;</pre></div></div>
            
        </li>
        
        
        <li>
            <div class="annotation annotation-34">
              
                <p>As a note of victory, let&#39;s just define some terms! :)</p>

              

              
            </div>
            
            <div class="content"><div class='highlight'><pre><a class='lineno' href='#line-1479' id='line-1479'>1479</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1480' id='line-1480'>1480</a>   <span class="keyword">func</span> cI -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1481' id='line-1481'>1481</a>     :<span class="reference">Def11</span>:
<a class='lineno' href='#line-1482' id='line-1482'>1482</a>     Abs(0,Var(0));
<a class='lineno' href='#line-1483' id='line-1483'>1483</a>   <span class="keyword">coherence</span>;
<a class='lineno' href='#line-1484' id='line-1484'>1484</a> 
<a class='lineno' href='#line-1485' id='line-1485'>1485</a>   <span class="keyword">func</span> cOne -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1486' id='line-1486'>1486</a>     :<span class="reference">Def11</span>:
<a class='lineno' href='#line-1487' id='line-1487'>1487</a>     Abs(0,Abs(1,App(Var(0),Var(1))));
<a class='lineno' href='#line-1488' id='line-1488'>1488</a>   <span class="keyword">coherence</span>;
<a class='lineno' href='#line-1489' id='line-1489'>1489</a> 
<a class='lineno' href='#line-1490' id='line-1490'>1490</a>   <span class="keyword">func</span> cK -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1491' id='line-1491'>1491</a>     :<span class="reference">Def13</span>:
<a class='lineno' href='#line-1492' id='line-1492'>1492</a>     Abs(0,Abs(1,Var(0)));
<a class='lineno' href='#line-1493' id='line-1493'>1493</a>   <span class="keyword">coherence</span>;
<a class='lineno' href='#line-1494' id='line-1494'>1494</a> 
<a class='lineno' href='#line-1495' id='line-1495'>1495</a>   <span class="keyword">func</span> cK* -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1496' id='line-1496'>1496</a>     :<span class="reference">Def14</span>:
<a class='lineno' href='#line-1497' id='line-1497'>1497</a>     Abs(0,Abs(1,Var(1)));
<a class='lineno' href='#line-1498' id='line-1498'>1498</a>   <span class="keyword">coherence</span>;
<a class='lineno' href='#line-1499' id='line-1499'>1499</a> 
<a class='lineno' href='#line-1500' id='line-1500'>1500</a>   <span class="keyword">func</span> cDelta -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1501' id='line-1501'>1501</a>     :<span class="reference">Def15</span>:
<a class='lineno' href='#line-1502' id='line-1502'>1502</a>     Abs(0,App(Var(0),Var(0)));
<a class='lineno' href='#line-1503' id='line-1503'>1503</a>   <span class="keyword">coherence</span>;
<a class='lineno' href='#line-1504' id='line-1504'>1504</a> 
<a class='lineno' href='#line-1505' id='line-1505'>1505</a>   <span class="keyword">func</span> cY -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1506' id='line-1506'>1506</a>     :<span class="reference">Def17</span>:
<a class='lineno' href='#line-1507' id='line-1507'>1507</a>     Abs(1,App(
<a class='lineno' href='#line-1508' id='line-1508'>1508</a>       Abs(0,App(Var(1),App(Var(0),Var(0)))),
<a class='lineno' href='#line-1509' id='line-1509'>1509</a>       Abs(0,App(Var(1),App(Var(0),Var(0))))
<a class='lineno' href='#line-1510' id='line-1510'>1510</a>     ));
<a class='lineno' href='#line-1511' id='line-1511'>1511</a>   <span class="keyword">coherence</span>;
<a class='lineno' href='#line-1512' id='line-1512'>1512</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-1513' id='line-1513'>1513</a> 
<a class='lineno' href='#line-1514' id='line-1514'>1514</a> <span class="keyword">definition</span>
<a class='lineno' href='#line-1515' id='line-1515'>1515</a>   <span class="keyword">func</span> cOmega -&gt; LambdaTerm <span class="keyword">equals</span>
<a class='lineno' href='#line-1516' id='line-1516'>1516</a>     :<span class="reference">Def16</span>:
<a class='lineno' href='#line-1517' id='line-1517'>1517</a>     App(cDelta,cDelta);
<a class='lineno' href='#line-1518' id='line-1518'>1518</a>   <span class="keyword">coherence</span>;
<a class='lineno' href='#line-1519' id='line-1519'>1519</a> <span class="keyword">end</span>;
<a class='lineno' href='#line-1520' id='line-1520'>1520</a> 
<a class='lineno' href='#line-1521' id='line-1521'>1521</a> <span class="error">::&gt;</span>
<a class='lineno' href='#line-1522' id='line-1522'>1522</a> <span class="error">::&gt; 4: This inference is not accepted</span>
<a class='lineno' href='#line-1523' id='line-1523'>1523</a> <span class="error">::&gt; 60: Something remains to be proved in this case</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { availableFonts: ["TeX"], scale: 90 }
  });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script>
$(function () {
  
  $(".collapsible").hide();
  $("a.toggle-collapsible").click(function () {
    $(this).next().toggle();
    return false;
  });

});
</script>
</body>
</html>
